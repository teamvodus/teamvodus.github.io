define("savePublish/utils/failedPanelUtil",["lodash"],function(e){"use strict";return{extractDocumentErrorCode:function(t){return e.get(t,"document.errorCode")||e.get(t,"documentServices.errorCode")},extractDocumentErrorType:function(t){return e.get(t,"document.errorType")||e.get(t,"documentServices.errorType")}}}),define("savePublish/constants/savePublishErrorPanelData",[],function(){"use strict";return{SITE_NAME_TAKEN_PANEL_DATA:{titleKey:"ERROR_SITE_NOT_RENAMED_TITLE_LABEL",description:"ERROR_SITE_NOT_RENAMED_BODY_SUBTITLE",steps:["ERROR_SITE_NOT_RENAMED_STEP1_TEXT","ERROR_SITE_NOT_RENAMED_STEP2_TEXT","ERROR_SITE_NOT_RENAMED_STEP3_TEXT"],stepsTitle:"ERROR_SITE_NOT_RENAMED_TRY_STEPS"},SAVE_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnSave",showSteps:!1,showFooterText:!1},USER_NOT_AUTHORIZED_FOR_SITE:{titleKey:"SAVE_ERROR_17_TITLE",description:"SAVE_ERROR_17_DESCRIPTION_HEADER",steps:["SAVE_ERROR_17_DESCRIPTION_STEP1","SAVE_ERROR_17_DESCRIPTION_STEP2","SAVE_ERROR_17_DESCRIPTION_STEP3"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_ERROR_LEARN_MORE_LINK"},NOT_LOGGED_IN:{titleKey:"SAVE_ERROR_15_TITLE",description:"SAVE_ERROR_15_DESCRIPTION_HEADER",steps:["SAVE_ERROR_15_DESCRIPTION_STEP1","SAVE_ERROR_15_DESCRIPTION_STEP2","SAVE_ERROR_15_DESCRIPTION_STEP3"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_ERROR_LEARN_MORE_LINK"},PUBLISH_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnPublish",showSteps:!1,showFooterText:!1},NAME_SITE_AGAIN_PANEL_DATA:{titleKey:"ERROR_NAME_SITE_AGAIN_TITLE_LABEL",description:"ERROR_NAME_SITE_AGAIN_SUBTITLE",steps:["ERROR_NAME_SITE_AGAIN_STEP1_TEXT","ERROR_NAME_SITE_AGAIN_STEP2_TEXT","ERROR_NAME_SITE_AGAIN_STEP3_TEXT"],stepsTitle:"ERROR_NAME_SITE_AGAIN_TRY_STEPS"},SAVE_ERROR_DEFAULT_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_SAVE_ERROR_OPTION_1","SAVE_PUBLISH_SAVE_ERROR_OPTION_2"],stepsTitle:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION_BOLD",helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"8045e8e4-6f47-4913-8d74-6239f21fffec"},PUBLISH_ERROR_DEFAULT_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_ERROR_OPTION_1","SAVE_PUBLISH_ERROR_OPTION_2"],helpMessage:"PUBLISH_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"3de8a931-e665-4c9f-bcb3-7096ea89f9e3"},VALIDATION_ERROR:{titleKey:"AUTOSAVE_VALIDATION_ERROR_TITLE_LABEL",description:"AUTOSAVE_VALIDATION_ERROR_SENT1",showSteps:!1,helpMessage:"AUTOSAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"AUTOSAVE_ERROR_HELP_CENTER",helpLink:"c525bfda-f732-4fc1-9b9e-7a919d38721d",confirmLabel:"AUTOSAVE_VALIDATION_ERROR_BTN_RELOAD"}}}),define("savePublish/managers/saveManager",["lodash","util","savePublish/utils/failedPanelUtil","baseUI","stateManagement","savePublish/constants/savePublishErrorPanelData","coreBi","constants","experiment"],function(e,t,n,s,i,a,o,r,l){"use strict";function c(c,p){function h(){for(var n=c.documentServices.siteName.getUsed(),s=t.translate("Save_Publish_Site_Default_Name"),i=c.siteName.sanitize(s.slice(0,20).replace(/\-$/,"").replace(/_/g,"-")),a=1;e.includes(n,i);){var o="-"+a;i=s.slice(0,20-o.length).replace(/\-$/,"").replace(/_/g,"-")+o,a++}return i}function m(t,n){switch(n){case c.documentServices.errors.save.SITE_NAME_TAKEN:S(t,a.SITE_NAME_TAKEN_PANEL_DATA);break;case c.documentServices.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:S(t,a.SAVE_DISABLED_ON_SERVER_PANEL_DATA);break;case c.documentServices.errors.save.NOT_LOGGED_IN:S(t,a.NOT_LOGGED_IN);break;case c.documentServices.errors.save.USER_NOT_AUTHORIZED_FOR_SITE:S(t,a.USER_NOT_AUTHORIZED_FOR_SITE);break;case c.documentServices.errors.save.DUPLICATE_COMPONENTS:case c.documentServices.errors.save.DATA_REFERENCE_MISMATCH:case c.documentServices.errors.save.MISSING_CONTAINERS:var s=e.partial(d,t);x=window.setInterval(s,r.SAVE_PUBLISH.VALIDATION_ERROR_POPUP_INTERVAL),s();break;case c.documentServices.errors.save.SAVE_DISABLED_IN_DOCUMENT_SERVICES:alert("SAVE IS DISABLED.\nIn order to prevent accidental changes for user sites, your editor has been opened with the save/autosave disabled.");break;default:S(t,a.SAVE_ERROR_DEFAULT_PANEL_DATA)}}function d(n){if(!B([H.SAVE_FAILED])){var s=t.windowInteractionUtils.reloadPageWithoutQuestion;S(n,e.assign({},a.VALIDATION_ERROR,{onConfirm:s}))}}function _(t){return new Promise(function(n,s){var i="autosave"===t?s:n,a=e.partial(T,n,s,t);c.panelManager.openPanel(H.CONCURRENT_SAVE,{overrideSaveMethod:a,onCancel:i,origin:t},!0)})}function S(t,s){var i=o.events.save.saveFailed,r=e.get(c.savePublish.getSiteState(),"isFirstSave"),l={errorCode:t&&n.extractDocumentErrorCode(t),biConfirm:r?i.First_Save_error_work_not_saved_error_ok_click:null,biHelp:r?i.First_Save_error_work_not_saved_error_help_center_link_click:null,biCancel:r?i.First_Save_error_work_not_saved_error_close_click:null},u=e({}).assign(s).defaults(a.SAVE_ERROR_DEFAULT_PANEL_DATA).assign(l).value();c.panelManager.openPanel(H.SAVE_FAILED,u,!0)}function E(t,n,s){return new Promise(function(i){if(c.account.isUserOwner()&&!c.wixStores.isSiteInWixStoreTestDrive()){var a=e.merge({},c.savePublish.getSiteState(),t);a.overrideTitle=n,a.overrideSubtitle=s,a.callback=i,c.panelManager.openPanel(H.SITE_WAS_SAVED,a,!0)}else i()})}function P(t){return new Promise(function(n,s){t=e(t).pick(["overrideTitle","overrideSubtitle"]).assign({defaultSiteName:h(),freeDomainPrefix:u.getFreeDomainPrefix(k.getState(),c.documentServices),connectDomainHandler:e.partial(f,t,n,s),freeDomainHandler:e.partial(b,t,n,s)}).value(),c.panelManager.openPanel(H.CHOOSE_DOMAIN,t,!0)})}function v(t){return new Promise(function(n){var s=c.savePublish.getSiteState();c.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:e.partial(n,t),isFirstSave:s.isFirstSave,isFirstPublish:!s.isSitePublished,isPremium:s.isSitePremium,flowId:r.CONNECT_DOMAIN.FLOWS.SAVE},!0)})}function b(e,t,n,s){g(s,e.origin,e).then(function(e){if(!e.preventSiteWasSavedPanel)return E()}).then(t).catch(n)}function I(e){return new Promise(function(t,n){c.site.getSiteDomainInfo(function(s){var i={isDomainConnected:s.isDomainConnected,isSitePremium:s.isSitePremium};s.isDomainConnected&&s.isSitePremium&&s.sitePublishedDomain&&(i.domain=s.sitePublishedDomain,c.documentServices.generalInfo.setPublicUrl(s.sitePublishedDomain)),c.savePublish.setSitePremiumState(i),e.preventSiteWasSavedPanel?t(e):E(i,V.SITE_SAVED_WELCOME_BACK_TITLE,V.SITE_SAVED_WELCOME_BACK_SUBTITLE).then(t).catch(n)},function(){e.preventSiteWasSavedPanel?t(e):E().then(t)})})}function f(e,t,n){g(h(),e.origin,e).then(v).then(I).then(t).catch(n)}function N(e,t,s){function i(){c.savePublish.setSaveProgress(!1),c.bi.tryFlushingConditionedEvents()}return s=s||{},c.savePublish.isSaveInProgress()?Promise.reject():(c.savePublish.setSaveProgress(!0),window.clearInterval(x),c.savePublish.save(e,t,s).then(function(e){return i(),("publish"===t||s.isPublish)&&l.isOpen("se_fixPublishFlow")?{preventSiteWasSavedPanel:!0}:e||{}}).catch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=e.errorOrigin,a=e.error;i();var o=n.extractDocumentErrorType(s);if(o===c.documentServices.errors.save.CONCURRENT_SAVE)return _(t).then(function(){return{preventSiteWasSavedPanel:!0}});throw m(s,o),{errorOrigin:s,error:a}}))}function T(e,n,s){"autosave"===s&&t.fedopsLogger.interactionStarted(t.fedopsLogger.INTERACTIONS.UI_SAVE),N(!0,s).then(function(e){if(!e.preventSiteWasSavedPanel)return E()}).then(e).catch(n)}function g(s,i,a){if(!c.savePublish.isSaveInProgress())return c.siteName.set(s),N(!0,i,a).then(function(n){return function(){var n=c.documentServices.generalInfo.getSiteId(),s=c.documentServices.generalInfo.getMetaSiteId(),i=t.url.parseUrl(window.location.href).query;delete i.siteId,i.metaSiteId=s;var a=e.template(F)({siteId:n});a=t.url.setUrlParams(a,i),t.windowInteractionUtils.replaceState({},"",a)}(),e.size(c.documentServices.wixapps.classics.getAllAppPartComps("blog"))>0&&c.documentServices.wixapps.classics.reloadApp("blog"),n},function(e){throw function(e){return c.documentServices.errors.save.SITE_NAME_TAKEN===n.extractDocumentErrorType(e)}(e)&&c.siteName.markAsUsed(s),e})}function A(){return new Promise(function(t){c.panelManager.openPanel(H.ON_BOARDING_MIGRATION,{onConfirm:t,onCancel:e.partial(t,"back_to_ADI")},!0)})}function O(e){return!e&&c.documentServices.generalInfo.isSiteFromOnBoarding()}function C(){if(l.isOpen("se_fixPublishFlow")){var e=r.USER_PREFS.SAVE.SHOW_CONNECT_DOMAIN;return i.editorPlugins.userPreferences.selectors.getSessionUserPreferences(e)(c.store.getState())}}function D(e){if(l.isOpen("se_fixPublishFlow")){var t=r.USER_PREFS.SAVE.SHOW_CONNECT_DOMAIN;c.store.dispatch(i.editorPlugins.userPreferences.actions.setSessionUserPreferences(t,e))}}function R(t){var n=(t=t||{}).origin||"";if(!c.savePublish.canSaveOrPublish())return p.error("Site is being saved or published!"),Promise.resolve();if(l.isOpen("se_obMigrationFlow")&&!e.get(t,"forceOBMigration")&&O(t.getBackToADI))return A().then(function(n){if("back_to_ADI"!==n)return t.onBoarding=!1,R(e.defaults({forceOBMigration:!0},t))});var s=c.savePublish.getSiteState();if(s&&s.isFirstSave||C())return l.isOpen("googleDomain")&&u.doesUserOwnGoogleDomain()?g(h(),n,t).then(function(e){if(!e.preventSiteWasSavedPanel)return E()}):P(t).then(function(){D(!1)});return N(!1,t.origin,t).then(function(e){if(!function(){var e=void 0;return l.isOpen("se_postSavePublishPreference")?(e=i.editorPlugins.userPreferences.selectors.getSiteUserPreferences(r.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)(c.store.getState()),w>Date.now()-e):e=!0===i.editorPlugins.userPreferences.selectors.getSessionUserPreferences(r.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)(c.store.getState())}()&&!e.preventSiteWasSavedPanel)return E({},"SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")})}function L(t,n){if(n=n||{},l.isOpen("se_obMigrationFlow")&&!e.get(n,"forceOBMigration")&&O(n.getBackToADI))return A().then(function(s){if("back_to_ADI"!==s)return n.onBoarding=!1,L(t,e.defaults({forceOBMigration:!0},n))});l.isOpen("se_backToADIFromEditor")&&n.getBackToADI&&(n.onBoarding=!0);var s=c.savePublish.getSiteState();return s&&s.isFirstSave?g(h(),t,n).then(function(){D(!0)}):C()?P(n).then(function(){D(!1)}):N(!1,t,n)}function U(){function t(){if(c.documentServices.generalInfo.isFirstSave()){var n=c.savePublish.canSaveOrPublish(),s=B(i),o=c.zoomMode.isInZoomMode(),l=c.mobile.mobileWizard.isEnabled();!n||s||o||l||(c.panelManager.openPanel(H.SAVE_REMINDER,{saveMethod:e.partial(R,c,{origin:"remember_to_save_active_save_popup"})},!0),window.clearTimeout(a)),window.setTimeout(t,r.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT)}}function n(){c.documentServices.generalInfo.isFirstSave()&&(!c.savePublish.canSaveOrPublish()||B(i)||c.zoomMode.isInZoomMode()||(s.tooltipManager.showForDuration("save-button-tooltip",r.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION),c.bi.event(o.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"save tool-tip"})),a=window.setTimeout(n,r.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT))}var i=[H.SAVE_REMINDER,H.CHOOSE_DOMAIN];window.setTimeout(t,r.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT);var a=window.setTimeout(n,r.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT);l.isOpen("se_obMigrationFlow")&&e.invoke(c,"documentServices.generalInfo.isSiteFromOnBoarding")&&window.setTimeout(function(){s.tooltipManager.showForDuration("save-button-tooltip",r.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION)},2e3)}function B(t){return e.some(c.panelManager.getOpenPanels(),function(n){return e.includes(t,n.name)})}function M(t,n){function s(e,t){c.savePublish.setSaveProgress(!1),c.savePublish.setPublishProgress(!1),e&&e(t)}c.documentServices&&c.documentServices.generalInfo&&c.documentServices.generalInfo.getUserInfo().isStudio?(c.savePublish.isSaveInProgress()&&n(),c.savePublish.setSaveProgress(!0),c.savePublish.setPublishProgress(!0),function(){var t=c.documentServices.pages.getPageIdList();e.forEach(t,function(e){y(e,"desktop"),y(e,"mobile")})}(),c.savePublish.saveAsTemplate(e.partial(s,t),e.partial(s,n))):p.info("Failed saving as template. User has no permissions to save as template")}function y(e,t){var n=c.documentServices.pages.background.get(e,t);n&&!n.isPreset&&(n.isPreset=!0,c.pages.background.update(e,n,t))}var k=c.store,w=2592e6,H={ON_BOARDING_MIGRATION:"savePublish.panels.save.onBoardingMigrationConfirmationPanel",CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel",SAVE_REMINDER:"savePublish.panels.save.saveReminderPanel"},V={SITE_SAVED_WELCOME_BACK_TITLE:"SAVE_SITE_SAVED_WELCOME_BACK_TITLE",SITE_SAVED_WELCOME_BACK_SUBTITLE:"SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"},F=(t.serviceTopology.editorServerRoot||"//editor.wix.com/html/editor/web")+"/renderer/edit/<%= siteId %>",x=void 0;return{save:R,saveInBackground:L,saveAsTemplate:M,setTimerForSaveReminder:e.once(U),openConcurrentSavePanel:_,displayFailurePanelMatchingAnErrorType:m}}var u=i.editorPlugins.domain.selectors;return c}),define("savePublish/managers/saveManagerWrapper",["lodash","util","savePublish/managers/saveManager"],function(e,t,n){"use strict";return function(s,i){var a=n(s,i);return{save:function(n){t.ravenUtils.breadcrumb({message:"user saved site"}),(n=n||{}).origin=n.origin||"";var s=n.callback||e.noop,i=n.onError||e.noop;"publish"!==n.origin&&t.fedopsLogger.interactionStarted(t.fedopsLogger.INTERACTIONS.UI_SAVE),a.save(n).then(function(){s(),"publish"!==n.origin&&t.fedopsLogger.interactionEnded(t.fedopsLogger.INTERACTIONS.UI_SAVE)}).catch(function(n){var s=n.errorOrigin,a=n.error,o=e.keys(s);t.ravenUtils.captureError(a,{tags:{user_save:!0,saveErrorOrigin:o[0]},extra:{errorOrigin:s}}),i(a)})},saveInBackground:function(n,o,r,l){s.savePublish.canSaveOrPublish()?((l=l||{}).isPublish||(t.ravenUtils.breadcrumb({message:"application triggered save",data:{origin:r,options:l}}),t.fedopsLogger.interactionStarted(t.fedopsLogger.INTERACTIONS.BG_SAVE),l.isSilent=!0),a.saveInBackground(r,l).then(function(){n(),l.isPublish||t.fedopsLogger.interactionEnded(t.fedopsLogger.INTERACTIONS.BG_SAVE)}).catch(function(n){var s=n.errorOrigin,i=n.error,a=e.keys(s);t.ravenUtils.captureError(i,{tags:{user_save:!0,saveErrorOrigin:a[0]},extra:{errorOrigin:s}}),l.isPublish?t.ravenUtils.captureError(i,{tags:{publish_save:!0,saveErrorOrigin:a[0]},extra:{errorOrigin:s}}):t.ravenUtils.captureError(i,{tags:{background_save:!0,saveErrorOrigin:a[0]},extra:{errorOrigin:s}}),o(i)})):i.error("Site is being saved or published!")},saveAsTemplate:a.saveAsTemplate,setTimerForSaveReminder:e.once(a.setTimerForSaveReminder),openConcurrentSavePanel:function(e,n,s){a.openConcurrentSavePanel(s).then(function(n){t.fedopsLogger.interactionEnded(t.fedopsLogger.INTERACTIONS.UI_SAVE),e(n)}).catch(function(e){n(e)})},displayFailurePanelMatchingAnErrorType:a.displayFailurePanelMatchingAnErrorType}}}),define("savePublish/constants/constants",["experiment"],function(e){"use strict";function t(e,t){return/^config\d+$/.test(e)?Number(e.replace("config","")):t}var n=e.getValue("se_autosaveActionCount"),s=e.getValue("se_saveAfterAutosaveCount"),i=e.getValue("se_autosaveInterval");return n=t(n,7),s=t(s,5),i=t(i,10),{ERROR_CODES:{SAVE_PUBLISH_DISABLED_ON_SERVER:-10132},SAVE:{SAVE_FAILED_HELP_LINK:"8045e8e4-6f47-4913-8d74-6239f21fffec"},AUTOSAVE:{AUTOSAVE_TIMEOUT:i,AUTOSAVE_ACTION_COUNT:n,SAVE_AFTER_AUTOSAVE_COUNT:s,DEBOUNCE_WAIT:2},RENAME:{ERRORS:{SITE_NAME_TAKEN:-40003}}}}),define("savePublish/managers/autosaveManager",["lodash","util","experiment","constants","savePublish/constants/constants","coreBi","savePublish/utils/failedPanelUtil","stateManagement"],function(e,t,n,s,i,a,o,r){"use strict";return function(l){function c(){var e=t.url.isQA(),n="true"===t.url.getParameterByName("forceAutosave");return e&&!n}function u(t){return e(["CONCURRENT_SAVE","CONCURRENT_AUTO_SAVE","SITE_STALE_STATE_FROM_AUTO_SAVE"]).map(e.propertyOf(l.documentServices.errors.save)).includes(o.extractDocumentErrorType(t))}function p(t,n){var s=void 0;s="autosave"===t?n?"autosaveSuccessCount":"autosaveFailCount":n?"autoFullSaveSuccessCount":"autoFullSaveFailCount",e.isNaN(Number(window.testApi[s]))&&(window.testApi[s]=0),window.testApi[s]++}function h(){l.savePublish.setDiffSaveProgress(!0),b()&&l.updateState({savingStatus:f.IN_PROGRESS})}function m(n,i){var o=n?f.DONE_FAILED:f.DONE_SUCCESS,c=n?f.IDLE:f.IDLE_SAVED;l.savePublish.setDiffSaveProgress(!1),b()&&(l.updateState({savingStatus:o}),window.setTimeout(function(){l.updateState({savingStatus:c})},s.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)),n&&u(n)&&l.saveManager.openConcurrentSavePanel(e.noop,P,"autosave"),l.store.dispatch(r.editorPlugins.leavePopup.actions.setLeavePopup(!!n)),l.bi.event(a.events.save.autosave.DIFF_SAVED,{type:i,success:!n}),t.url.isQA()&&"undefined"!=typeof window&&window.testApi&&p("autosave",!n),S()}function d(){b()&&(l.savePublish.setSaveProgress(!0),l.updateState({savingStatus:f.IN_PROGRESS}))}function _(n){var i=n?f.DONE_FAILED:f.DONE_SUCCESS,a=n?f.IDLE:f.IDLE_SAVED;b()&&(l.savePublish.setSaveProgress(!1),l.updateState({savingStatus:i}),l.store.dispatch(r.editorPlugins.leavePopup.actions.setLeavePopup(!!n)),window.setTimeout(function(){l.updateState({savingStatus:a})},s.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)),n&&(u(n)?l.saveManager.openConcurrentSavePanel(e.noop,P,"autosave"):l.saveManager.displayFailurePanelMatchingAnErrorType(n)),t.url.isQA()&&"undefined"!=typeof window&&window.testApi&&p("autoFullSave",!n),S()}function S(){l.bi.tryFlushingConditionedEvents()}function E(t){return e.assign({},{enabled:!0},{onDiffSaveStarted:h,onDiffSaveFinished:m,onPartialSaveStarted:d,onPartialSaveFinished:_},i.AUTOSAVE,t)}function P(){t.windowInteractionUtils.reloadPageWithoutQuestion()}function v(){if(b()){var e=s.ROOT_COMPS.TOPBAR.DROP_PANELS.CUSTOM.AUTO_SAVE;l.topBarMenuBar.openDropDown(e),window.setTimeout(l.topBarMenuBar.closeDropDown.bind(l,e),s.SAVE_PUBLISH.SITE_AUTO_SAVED_TOOLTIP_DURATION)}}function b(){var e=l.documentServices;if(!e)return!1;var t=e.getAutoSaveInfo(),s=t&&t.shouldAutoSave,i=I();return n.isOpen("se_autosaveUI")&&s&&!i}function I(){return!n.isOpen("se_autosavePlatform")&&(l.documentServices.wixCode.isProvisioned()||l.developerMode.isEnabled())}var f=s.PROGRESS_STATUS;return{init:function(e,t){var n=!e||e.enable,s=c()||I();if(n&&s)return!1;var i=E(e);l.documentServices.initAutosave(i);var a=l.documentServices.generalInfo.isSiteFromOnBoarding();return!t&&i.enabled&&b()&&!a&&v(),i},getAutosaveConfig:E,showSiteAutoSavedTooltipIfNeeded:v,shouldShowAutosaveUI:b,isAutomationWithoutAutosave:c}}}),define("savePublish/managers/mockSaveManager",["lodash","savePublish/constants/savePublishErrorPanelData","constants","coreUtilsLib"],function(e,t,n,s){"use strict";function i(){for(var t=m.documentServices.siteName.getUsed(),n=m.documentServices.siteName.get(),s=n.slice(0,20),i=1;e.includes(t,s);){var a="-"+i;s=n.slice(0,20-a.length)+a,i++}return s}function a(){m.panelManager.openPanel(h.SAVE_FAILED,t.SAVE_ERROR_DEFAULT_PANEL_DATA,!0)}function o(t,n){var s=e.clone(d);s.isMockSave=!0,s.overrideTitle=t,s.overrideSubtitle=n,m.panelManager.openPanel(h.SITE_WAS_SAVED,s,!0)}function r(t){d.shouldSaveSucceed?(c(),function(t){d=e.merge(d||{},t)}({domain:p+t}),o()):a()}function l(){d.shouldSaveSucceed?(c(),function(){m.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:o.bind(this,"SAVE_SITE_SAVED_WELCOME_BACK_TITLE","SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"),isFirstSave:!0,isFirstPublish:!0,isPremium:d.isSitePremium,flowId:n.CONNECT_DOMAIN.FLOWS.SAVE},!0)}()):a()}function c(){s.log.info("First Save Was Performed!")}function u(t){function n(t){t.isDomainConnected||(t.domain=p+i()),function(t){d=e.clone(t)}(t),t.isFirstSave?function(){var e={defaultSiteName:i(),freeDomainPrefix:p,connectDomainHandler:l,freeDomainHandler:r};m.panelManager.openPanel(h.CHOOSE_DOMAIN,e,!0)}():t.shouldSaveSucceed?(s.log.info("Save Was Performed!"),o("SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")):a()}(m=t).panelManager.openPanel("savePublish.panels.save.saveConfigurationPanel",{onConfirm:n},!0)}var p="http://www.wix.com/",h={CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel"},m=null,d=null;return{save:u}}),define("savePublish/panels/publish/publishInnerPanelTypes",["constants"],function(){"use strict";return{EMPTY:{name:"EMPTY"},SHOUTOUT:{name:"SHOUTOUT",userPref:!0},CONNECT_DOMAIN:{name:"CONNECT_DOMAIN",userPref:!0},GROW_BUSINESS:{name:"GROW_BUSINESS",userPref:!0}}}),define("savePublish/managers/publishManager",["lodash","util","coreUtilsLib","savePublish/utils/failedPanelUtil","savePublish/constants/savePublishErrorPanelData","savePublish/panels/publish/publishInnerPanelTypes","stateManagement","coreBi","constants","experiment"],function(e,t,n,s,i,a,o,r,l,c){"use strict";function u(u){function m(){t.fedopsLogger.interactionEnded(t.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE)}function d(){function t(){function t(){!function(e,t){u.site.getSiteDomainInfo(function(t){var n=t.isDomainConnected,s=t.sitePublishedDomain;e({sitePremiumDomain:s,isDomainConnected:n})},t)}(function(t){P(e.assign(n,t)),S()},S),m()}var n={isFirstSave:u.documentServices.generalInfo.isFirstSave(),isPremiumUser:u.site.isPremium(),isFirstPublish:!u.documentServices.generalInfo.isSitePublished()};u.savePublish.publish().then(t,_)}u.savePublish.canSaveOrPublish()&&(u.account.isUserOwner()&&!u.wixStores.isSiteInWixStoreTestDrive()?(u.savePublish.setPublishProgress(!0),t()):u.savePublish.publish().then(function(){S(),m()},_))}function _(e){switch(s.extractDocumentErrorType(e)){case u.documentServices.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:E(e,i.PUBLISH_DISABLED_ON_SERVER_PANEL_DATA);break;default:E(e,i.PUBLISH_ERROR_DEFAULT_PANEL_DATA)}S()}function S(){u.savePublish.setPublishProgress(!1)}function E(t,n){var a={errorCode:s.extractDocumentErrorCode(t),biConfirm:r.events.publish.Publish_Work_not_Published_Error_ok_Click,biHelp:r.events.publish.Publish_Work_not_Published_Error_Help_Center_Link_Click},o=e.chain(n).clone().defaults(i.PUBLISH_ERROR_DEFAULT_PANEL_DATA).assign(a).value();u.panelManager.openPanel(g,o,!0)}function P(t){var n=u.documentServices.generalInfo.getPublicUrl()||p.getFreeDomainPrefix(f.getState(),u.documentServices)+u.siteName.get();n=t.isDomainConnected?t.sitePremiumDomain:n;var s=l.USER_PREFS.PUBLISH,i=function(){var e=l.USER_PREFS.PUBLISH;if(c.isOpen("se_postSavePublishPreference")){var t=o.editorPlugins.userPreferences.selectors.getSiteUserPreferences(e.POST_PUBLISH_DONT_SHOW_AGAIN)(u.store.getState());return h>Date.now()-t}return o.editorPlugins.userPreferences.selectors.getSessionUserPreferences(e.POST_PUBLISH_DONT_SHOW_AGAIN)(u.store.getState())}(),r=function(e,t){var n=a.EMPTY;if(!e.isPremiumUser&&e.isDomainConnected)return n;if(v(e))n=a.CONNECT_DOMAIN;else{var s=b(e,t);if(s.length){var i=u.store.getState().savePublish.publishPanelPromotionIndex;n=s[i%s.length]||a.EMPTY}}return n}(t,i);if(function(e){return!v(e)}(t)&&function(t,n){var s=u.store.getState(),i=b(t,n),a=(s.savePublish.publishPanelPromotionIndex+1)%(i.length||1);u.updateState(e.merge({},s.savePublish,{savePublish:{publishPanelPromotionIndex:a}}))}(t,i),!e.isEqual(r,a.EMPTY)){var m={isFakePanel:t.isFakePublish,contentPanelType:r,configuration:t,currentDomain:u.site.getCurrentSiteDomain(),setDontShowPanelValue:function(e){return u.store.dispatch(o.editorPlugins.userPreferences.actions.setSessionUserPreferences(s.POST_PUBLISH_DONT_SHOW_AGAIN,e))},sitePublicUrl:n,closePanel:I};c.isOpen("se_postSavePublishPreference")&&(m.setDontShowPanelValue=function(e){e&&u.store.dispatch(o.editorPlugins.userPreferences.actions.setSiteUserPreferences(s.POST_PUBLISH_DONT_SHOW_AGAIN,Date.now()))}),u.panelManager.openPanel(T,m,!0)}}function v(e){return e.isFirstPublish&&!e.isDomainConnected}function b(e,t){var n=[],s=function(e,t){return!e.isDomainConnected&&(!t||e.isFakePublish)}(e,t),i=function(e,t){return!e.isDomainConnected&&(!t||e.isFakePublish)}(e,t),o=function(e,t){return e.isPremiumUser&&e.isDomainConnected&&(!t||e.isFakePublish)}(e,t);return s&&n.push(a.CONNECT_DOMAIN),i&&n.push(a.SHOUTOUT),o&&n.push(a.GROW_BUSINESS),n}function I(){return u.panelManager.closePanelByName(T)}var f=u.store,N="savePublish.panels.publish.config.publishConfigurationPanel",T="savePublish.panels.publish.publishSuccessPanel",g="savePublish.panels.common.failPanel";return{publish:d,saveAndPublish:function(e){if(t.fedopsLogger.interactionStarted(t.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),u.savePublish.canSaveOrPublish())if(u.documentServices.generalInfo.isFirstSave()){var n={overrideTitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_TITLE",overrideSubtitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_SUBTITLE",callback:d,origin:"publish",isPublish:!0};u.saveManager.save(n)}else u.saveManager.saveInBackground(d,_,e,{isPublish:!0})},configureMockPostPublish:function(){u.panelManager.openPanel(N,{onConfirm:function(t){(t=e.assign({},t,{isFakePublish:!0})).shouldPublishSucceed&&!t.isSiteContributor?P(t):t.shouldPublishSucceed&&t.isSiteContributor?(n.log.info("Contributors dont get to see any post operations except failure."),S()):E()}})}}}var p=o.editorPlugins.domain.selectors,h=2592e6;return u}),define("savePublish/panels/connectDomain/connectDomainPanel.rt",["react","lodash","panels","util","baseUI","symbols"],function(e,t,n,s,i,a){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{className:"connect-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:function(){this.onClose(!1)}.bind(this)},e.createElement(a.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.translateIfNeeded(this.props.title)),e.createElement("span",{className:"subtitle"},this.translateIfNeeded(this.props.subtitle))),e.createElement("div",{className:"actions"},e.createElement("a",{className:"action",onClick:this.connectToNewDomain,onMouseEnter:function(){this.hoverOnAction(1)}.bind(this),onMouseLeave:this.resetHoverOnAction},e.createElement("div",{className:"action-graphics"},e.createElement(i.symbol,{name:"connectNewDomain"})),e.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_1")),this.isActionHovered(1)?null:e.createElement("div",{key:"optionArrow",className:"action-arrow"},e.createElement(i.symbol,{name:"arrowWithCircle"})),this.isActionHovered(1)?e.createElement("div",{key:"optionLink",className:"action-arrow"},e.createElement(i.symbol,{name:"openLinkInWindow"})):null),e.createElement("a",{className:"action",onClick:this.connectExistingDomain,onMouseEnter:function(){this.hoverOnAction(2)}.bind(this),onMouseLeave:this.resetHoverOnAction},e.createElement("div",{className:"action-graphics"},e.createElement(i.symbol,{name:"connectDomainLight"})),e.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_2")),this.isActionHovered(2)?null:e.createElement("div",{key:"optionArrow",className:"action-arrow"},e.createElement(i.symbol,{name:"arrowWithCircle"})),this.isActionHovered(2)?e.createElement("div",{key:"optionLink",className:"action-arrow"},e.createElement(i.symbol,{name:"openLinkInWindow"})):null)),e.createElement("div",{className:"connect-domain-panel-footer"},e.createElement(i.button,{type:"button",label:"PREMIUM_BUTTON_LABEL",className:"maybe-later-button",onClick:this.maybeLater})))}}),define("savePublish/panels/connectDomain/connectDomainPanel",["create-react-class","prop-types","zepto","lodash","core","util","coreBi","constants","savePublish/panels/connectDomain/connectDomainPanel.rt"],function(e,t,n,s,i,a,o,r,l){"use strict";return e({displayName:"connectDomainPanel",mixins:[i.mixins.editorAPIMixin,a.translationMixin],propTypes:{isPremium:t.bool.isRequired,isFirstSave:t.bool,isFirstPublish:t.bool,title:t.string,subtitle:t.string,panelName:t.string,onConnectDomainFlowEnded:t.func,flowId:t.oneOf(s.values(r.CONNECT_DOMAIN.FLOWS)).isRequired},getInitialState:function(){return{actionIndexHovered:-1}},connectToNewDomain:function(){var e=o.events.save.siteWasSavedPanel.CONNECT_NEW_DOMAIN_CLICKED,t=this.openUpgrade.bind(this,"CONNECT_NEW_DOMAIN");this.props.isPremium&&(t=this.openConnectDomainInWindow.bind(this,"CONNECT_NEW_DOMAIN")),this.connectDomain(e,t)},connectExistingDomain:function(){var e=o.events.save.siteWasSavedPanel.CONNECT_EXISTING_DOMAIN_CLICKED,t=this.openUpgrade.bind(this,"CONNECT_EXISTING_DOMAIN");this.props.isPremium&&(t=this.openConnectDomainInWindow.bind(this,"CONNECT_EXISTING_DOMAIN")),this.connectDomain(e,t)},connectDomain:function(e,t){this.props.isFirstSave&&this.getEditorAPI().bi.event(e);var n=this.listenToTabFocusIfNeeded();t.call(this),this.onClose(n)},listenToTabFocusIfNeeded:function(){if(this.props.onConnectDomainFlowEnded){var e=function(){this.getWindow().off("focus",e),this.props.onConnectDomainFlowEnded()}.bind(this);return this.getWindow().on("focus",this.onEditorFocus),!0}return!1},onEditorFocus:function(){this.getWindow().off("focus",this.onEditorFocus),this.props.onConnectDomainFlowEnded()},getReferralCode:function(e){var t="edhtml_";switch(this.props.flowId){case r.CONNECT_DOMAIN.FLOWS.SAVE:t+="SAVE_FLOW_",t+=this.props.isFirstSave?"FIRST_SAVE_":"SECOND_SAVE_",t+=e;break;case r.CONNECT_DOMAIN.FLOWS.TOP_BAR:t+="TOP_BAR_SITE_MENU_CONNECT_DOMAIN_"+e;break;case r.CONNECT_DOMAIN.FLOWS.PUBLISH:t+="PUBLISH_FLOW_",t+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",t+=e;break;case r.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON:t+="PUBLISH_FLOW_CONNECT_BUTTON_",t+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",t+=e;break;default:t=null}return t},openUpgrade:function(e){var t=this.getReferralCode(e);this.getEditorAPI().account.upgrade(t)},openConnectDomainInWindow:function(e){var t=this.createURLWithParams("https://premium.wix.com/wix/api/domainConsole?siteGuid=<%= siteGUID %>&referralAdditionalInfo=<%= referralInfo %>",e);window.open(t)},createURLWithParams:function(e,t){var n=this.getReferralCode(t);return s.template(e)({siteGUID:this.getEditorAPI().documentServices.generalInfo.getSiteId(),referralInfo:n})},maybeLater:function(){this.getEditorAPI().bi.event(o.events.save.siteWasSavedPanel.First_Save_Dialog_2_maybe_later_click),this.onClose(!1)},onClose:function(e){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName),!e&&this.props.onConnectDomainFlowEnded&&this.props.onConnectDomainFlowEnded()},getWindow:function(){return n(window)},resetHoverOnAction:function(){this.hoverOnAction(-1)},hoverOnAction:function(e){this.setState({actionIndexHovered:e})},isActionHovered:function(e){return this.state.actionIndexHovered===e},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.maybeLater()},esc:function(){e.onClose(!1)}}},render:l})}),define("savePublish/panels/connectDomain/connectDomainInProgress.rt",["react","lodash","panels","util","baseUI","symbols"],function(e,t,n,s,i,a){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{className:"connect-domain-in-progress-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},e.createElement("div",{className:"save-publish-panel-header"},e.createElement("div",{className:"title"},s.translate("PUBLISH_HANGON_TITLE")),e.createElement("div",{className:"subtitle"},s.translate("PUBLISH_HANGON_SUBTITLE")),e.createElement("button",{className:"close-button",onClick:this.onClose},e.createElement(a.symbol,{name:"headerCloseButton"}))),e.createElement("div",{className:"panel-content"},e.createElement("div",{className:"content-top-part"},e.createElement("div",{className:"content-graphics"},e.createElement(i.symbol,{name:"hangon"})),e.createElement("div",{className:"content-top-message"},"\n                ",s.translate("PUBLISH_HANGON_MAIN_TEXT"),"\n                ",e.createElement("span",{className:"public-url"},this.props.connectedDomainURL))),e.createElement("div",{className:"content-bottom-message"},"\n            ",s.translate("PUBLISH_HANGON_MEANTIME_TEXT"),"\n            ",e.createElement("a",{className:"content-bottom-message-link",onClick:this.openWorkingURL},s.translate("PUBLISH_HANGON_CLICKING_HERE_LINK")))),e.createElement("div",{className:"connect-domain-panel-footer"},e.createElement(i.button,{type:"button",className:"maybe-later-button",label:"PUBLISH_HANGON_DONE_BUTTON",onClick:this.onClose})))}}),define("savePublish/panels/connectDomain/connectDomainInProgress",["create-react-class","prop-types","savePublish/panels/connectDomain/connectDomainInProgress.rt"],function(e,t,n){"use strict";return e({displayName:"connectDomainInProgress",propTypes:{connectedDomainURL:t.string.isRequired,currentPublicURL:t.string.isRequired,panelName:t.string},getShortcuts:function(){return{esc:this.onClose,enter:this.onClose}},openWorkingURL:function(){window.open(this.props.currentPublicURL)},onClose:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:n})}),define("savePublish/panels/common/failPanel.rt",["react","lodash","util","baseUI","panels"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(i.frames.messagePanelFrame,{panelName:this.props.panelName,className:"fail-panel",panelTitle:n.translate(this.props.titleKey),confirmLabel:this.getConfirmLabel(),footerText:this.props.showFooterText?this.getFooterText():null,keyboardShortcuts:this.getShortcuts()},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"icon"},e.createElement(s.symbol,{name:"plaster"})),-40108!==this.props.errorCode?e.createElement("div",{className:"textual",key:"errorNot-40108"},e.createElement("p",{className:"description",dangerouslySetInnerHTML:{__html:n.translate(this.props.description)}}),this.props.showSteps&&this.props.stepsTitle?e.createElement("div",{key:"stepsTitle",className:"steps-title"},n.translate(this.props.stepsTitle)):null,this.props.showSteps?e.createElement.apply(this,["ol",{key:"steps"},t.map(this.props.steps,function(t,s){return e.createElement("li",{key:t},n.translate(t))}.bind(this))]):null):null,-40108===this.props.errorCode?e.createElement("div",{className:"textual",key:"error-40108"},e.createElement("h3",{},n.translate("PUBLISH_ERROR_SITE_DELETED_TITLE")),e.createElement("p",{className:"description"},n.translate("PUBLISH_ERROR_SITE_DELETED_BODY"))):null))}}),define("savePublish/panels/common/failPanel",["lodash","react-dom-factories","create-react-class","prop-types","core","util","constants","savePublish/panels/common/failPanel.rt"],function(e,t,n,s,i,a,o,r){"use strict";return n({displayName:"failPanel",mixins:[i.mixins.editorAPIMixin],propTypes:{titleKey:s.string.isRequired,description:s.string.isRequired,stepsTitle:s.string,steps:s.array.isRequired,helpMessage:s.string.isRequired,helpLinkMessage:s.string.isRequired,helpLink:s.string.isRequired,errorCode:s.number,biEvent:s.object,biParams:s.object,failHelpId:s.string,biConfirm:s.object,biHelp:s.object,biCancel:s.object,onConfirm:s.func,confirmLabel:s.string,panelName:s.string},getDefaultProps:function(){return{showSteps:!0,showFooterText:!0,panelName:"savePublish.panels.common.failPanel"}},getShortcuts:function(){var e=this;return{esc:function(){e.getEditorAPI().panelManager.closePanelByName(e.props.panelName),e.onCancel()},enter:function(){e.getEditorAPI().panelManager.closePanelByName(e.props.panelName),e.onConfirm()}}},getErrorCodeMessage:function(){return void 0!==this.props.errorCode&&null!==this.props.errorCode?" (Error Code: "+this.props.errorCode+")":""},getFooterText:function(){return-40108===this.props.errorCode?"":t.p({className:"fail-panel-help-text"},t.span({className:"text-part"},a.translate(this.props.helpMessage)),t.a({onClick:this.openHelpLink,className:"link-part"},a.translate(this.props.helpLinkMessage)),t.span({className:"error-code-part"},this.getErrorCodeMessage()))},getConfirmLabel:function(){return-40108===this.props.errorCode?"PUBLISH_ERROR_SITE_DELETED_LINK":this.props.confirmLabel||"SAVE_PUBLISH_ERROR_BUTTON_OK"},onCancel:function(){this.props.biCancel&&this.getEditorAPI().bi.event(this.props.biCancel)},onConfirm:function(){this.props.biConfirm&&this.getEditorAPI().bi.event(this.props.biConfirm),-40108!==this.props.errorCode?e.invoke(this.props,"onConfirm"):window.location="https://wix.com/"},openHelpLink:function(){var e=this.getEditorAPI();this.props.biHelp&&this.getEditorAPI().bi.event(this.props.biHelp);var t={panel_name:this.props.panelName,origin:o.BI.HELP.ORIGIN.PANEL,learn_more:!0};e.panelManager.openHelpCenter(this.props.helpLink,null,t),e.panelManager.closePanelByName(this.props.panelName)},sendPanelLoadedBiEvent:function(){this.props.biEvent&&this.props.biParams&&this.getEditorAPI().bi.event(this.props.biEvent,this.props.biParams)},componentDidMount:function(){this.sendPanelLoadedBiEvent()},render:r})}),define("savePublish/panels/common/commonPanels",["savePublish/panels/common/failPanel"],function(e){"use strict";return{failPanel:e}}),define("savePublish/panels/save/chooseDomainPanel.rt",["react","lodash","panels","baseUI","symbols"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{className:"choose-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:this.close},e.createElement(i.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.getTitle()),e.createElement("span",{className:"subtitle"},this.getSubtitle())),function(){var n=this.getOptions()[this.DomainStates.FREE];return e.createElement("label",{className:t({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.FREE}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement("span",{className:"domain-option-label"},n.label),e.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:n.value,checked:this.state.domainChoice===n.value,onChange:function(e){this.handleDomainOptionSelected(e.value)}.bind(this,n)}),e.createElement("span",{}),e.createElement("div",{className:"domain-input"},e.createElement(s.domainInput,{value:n.domain,onChange:this.handleDomainChanged,prefix:n.prefix,isEditable:n.isEditable,domainValidator:n.domainValidator,biHandler:this.domainInputBiReporter})))}.apply(this,[]),function(){var n=this.getOptions()[this.DomainStates.BUY];return e.createElement("label",{className:t({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.BUY}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement("span",{className:"domain-option-label"},n.label),e.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:n.value,checked:this.state.domainChoice===n.value,onChange:function(e){this.handleDomainOptionSelected(e.value)}.bind(this,n)}),e.createElement("span",{}),e.createElement("span",{className:"connect-domain-example"},n.domain))}.apply(this,[]),e.createElement(s.button,{className:"choose-domain-action-button",shouldTranslate:!1,label:this.getActionButtonLabel(),onClick:this.handleAction,disabled:this.state.isActionDisabled}))}}),define("savePublish/panels/save/chooseDomainPanel",["create-react-class","prop-types","lodash","core","util","coreBi","savePublish/panels/save/chooseDomainPanel.rt"],function(e,t,n,s,i,a,o){"use strict";return e({displayName:"chooseDomainPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{defaultSiteName:t.string.isRequired,freeDomainPrefix:t.string.isRequired,freeDomainHandler:t.func.isRequired,connectDomainHandler:t.func.isRequired,overrideTitle:t.string,overrideSubtitle:t.string,panelName:t.string,isDomainConnected:t.bool,isSitePublished:t.bool},DomainStates:{FREE:"free",BUY:"buy"},getInitialState:function(){var e=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);return{domainChoice:this.DomainStates.FREE,siteName:this.props.defaultSiteName,sanitizedSiteName:this.props.defaultSiteName,isActionDisabled:!e.success}},getTitle:function(){return i.translate(this.props.overrideTitle||"SAVE_CHOOSE_DOMAIN_TITLE_TITLE")},getSubtitle:function(){return i.translate(this.props.overrideSubtitle||"SAVE_CHOOSE_DOMAIN_TITLE_SUBTITLE")},getOptions:function(){var e={};return e[this.DomainStates.FREE]={value:"free",label:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_1"),prefix:this.props.freeDomainPrefix,domain:this.state.siteName,isEditable:this.state.domainChoice===this.DomainStates.FREE,domainValidator:this.getEditorAPI().siteName.validate},e[this.DomainStates.BUY]={value:"buy",label:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE1"),domain:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE2"),isEditable:!1},e},getNextDomainOptionValue:function(){return this.state.domainChoice===this.DomainStates.FREE?this.DomainStates.BUY:this.DomainStates.FREE},getActionButtonLabel:function(){return i.translate("SAVE_CHOOSE_DOMAIN_BUTTON_SAVENCONTINUE")},handleDomainChanged:function(e){var t={};t.isActionDisabled=!e.isValid,t.siteName=e.value,t.sanitizedSiteName=e.sanitizedValue,this.setState(t)},handleDomainOptionSelected:function(e){if(!n.isEqual(this.state.domainChoice,e)){var t={domainChoice:e};if(e===this.DomainStates.BUY)t.isActionDisabled=!1,t.siteName=this.props.defaultSiteName,t.sanitizedSiteName=this.props.defaultSiteName;else{var s=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);t.isActionDisabled=!s.success}this.setState(t),this.reportDomainClickedBI(e)}},handleAction:function(){if(this.reportActionButtonClickedBI(this.state.domainChoice),this.state.isActionDisabled)throw new Error("Should not get to handleAction if continue button is disabled");this.state.domainChoice===this.DomainStates.FREE?(this.close(),this.props.freeDomainHandler(this.state.sanitizedSiteName)):this.state.domainChoice===this.DomainStates.BUY&&(this.close(),this.props.connectDomainHandler())},reportActionButtonClickedBI:function(e){var t=this.getEditorAPI(),n=e===this.DomainStates.BUY?"connect your own domain":"free WIX domain";t.bi.event(a.events.save.chooseDomainPanel.ACTION_BUTTON_CLICKED,{value_selected:n})},reportDomainClickedBI:function(e){var t=this.getEditorAPI(),n=e===this.DomainStates.BUY?"connect your own domain":"free WIX domain";t.bi.event(a.events.save.chooseDomainPanel.DOMAIN_OPTION_CLICKED,{selection:n})},getUserStatus:function(){var e="";return this.props.isSitePublished||(e+="not_"),e+="published_",this.props.isDomainConnected||(e+="not_"),e+="connected"},domainInputBiReporter:function(e){var t={user_status:"not_published_not_connected",panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:1};this.getEditorAPI().bi.event(a.events.domainInput[e],t)},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.state.isActionDisabled||e.handleAction()},esc:function(){e.close()},tab:function(t){e.handleDomainOptionSelected(e.getNextDomainOptionValue()),t.preventDefault()}}},render:o})}),define("savePublish/panels/save/siteWasSavedPanel.rt",["react","lodash","panels","baseUI","baseUILib","util","symbols"],function(e,t,n,s,i,a,o){"use strict";return function(){function r(){var n=this.getInnerPanel();return e.createElement("div",{className:"wrapper"},e.createElement("div",{className:"domain-input"},e.createElement(s.domainInputWithEditButtons,this.getDomainInputProps())),this.shouldDisplayInnerPanel()?e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({key:"innerPanel",className:"inner-panel "+this.getInnerPanelClass()},this.getInnerPanelProps())):null,e.createElement("div",{className:"site-saved-footer"},this.props.isFirstSave?null:e.createElement(i.Checkbox,{key:"dontShowAgainCheckbox",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",valueLink:{value:this.state.doNotShowAgain,requestChange:this.handleDontShowAgainClicked},labelAfterSymbol:!0}),this.props.isSitePremium&&!this.props.isDomainConnected&&this.props.isFirstSave?e.createElement("span",{key:"needHelpConnectingDomain",className:"help-connecting-domain"},a.translate("SAVE_SITE_SAVED_NEED_HELP_LABEL")+" ",e.createElement("a",{target:"_blank",href:a.translate("SAVE_SITE_SAVED_NEED_HELP_URL"),onClick:this.handleNeedHelpConnectingDomainClicked},a.translate("SAVE_SITE_SAVED_NEED_HELP_LINK"))):null,e.createElement("div",{className:"footer-buttons"},this.props.isSitePublished?e.createElement(s.button,{onClick:this.continueToPublish,key:"publishButton",className:"publish-button btn-confirm-secondary",label:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",disabled:this.state.isContinueDisabled}):null,e.createElement(s.button,{className:"continue-button btn-confirm-primary",label:"SAVE_SITE_SAVED_BUTTON_OK",onClick:this.continueEditing,disabled:this.state.isContinueDisabled}))))}return e.createElement(n.frames.focusPanelFrame,{className:this.getPanelClass(),panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:this.close},e.createElement(o.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.getPanelTitle()),e.createElement("span",{className:"subtitle"},this.getPanelSubtitle())),r.apply(this,[]))}}),define("savePublish/panels/content/generalContent.rt",["react","lodash","baseUILib","baseUI"],function(e,t,n,s){"use strict";return function(){return e.createElement("div",{className:this.getClassName()},e.createElement("div",{className:"main-title-wrapper"},e.createElement(n.Divider,{long:!0}),e.createElement("div",{className:"main-title"},this.translateIfNeeded(this.props.mainTitle)),e.createElement(n.Divider,{long:!0})),e.createElement("div",{className:"middle-spacer"}),e.createElement("div",{className:"bottom-section"},e.createElement("div",{className:"left-side"},this.props.symbolName?e.createElement(s.symbol,{name:this.props.symbolName,key:"symbol"}):null,this.props.imageSrc?e.createElement("img",{key:"image",src:this.props.imageSrc,style:this.props.imageStyle||{}}):null),e.createElement("div",{className:"right-side"},e.createElement("div",{className:"title"},this.translateIfNeeded(this.props.title)),this.props.subtitle?e.createElement("div",{key:"subtitle",className:"subtitle",dangerouslySetInnerHTML:{__html:this.translateIfNeeded(this.props.subtitle)}}):null,e.createElement("a",{className:"general-content-action",onClick:this.props.actionCallback},this.translateIfNeeded(this.props.actionLabel)))))}}),define("savePublish/panels/content/generalContent",["create-react-class","prop-types","util","savePublish/panels/content/generalContent.rt"],function(e,t,n,s){"use strict";return e({displayName:"generalContent",mixins:[n.translationMixin],propTypes:{symbolName:t.string,imageSrc:t.string,imageStyle:t.object,mainTitle:t.string.isRequired,title:t.string.isRequired,subtitle:t.string,actionCallback:t.func.isRequired,actionLabel:t.string.isRequired,className:t.string},getClassName:function(){return"general-content"+(this.props.className?" "+this.props.className:"")},render:s})}),define("savePublish/panels/content/connectDomain.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:"connect-domain-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/connectDomain",["lodash","core","create-react-class","prop-types","util","savePublish/panels/content/connectDomain.rt","constants","experiment"],function(e,t,n,s,i,a,o,r){"use strict";var l=r.isOpen("spanishUpgradeText")?"UPGRADE_NOW_FOR_SPAIN_ONLY":"SAVE_PUBLISH_WHATS_NEXT_UPGRADE_LINK";return n({displayName:"connectDomain",mixins:[t.mixins.editorAPIMixin],propTypes:{className:s.string,closePanel:s.func.isRequired,sitePublishedDomain:s.string,currentDomain:s.string,isDomainConnected:s.bool,isFirstPublish:s.bool,isSitePremium:s.bool,isFirstSave:s.bool,actionCallback:s.func,flowId:s.oneOf(e.values(o.CONNECT_DOMAIN.FLOWS)).isRequired},getGeneralContentProps:function(){var t=this.getEditorAPI(),n={className:"",symbolName:"connectDomain",mainTitle:i.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:i.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE1"),actionLabel:i.translate(this.props.isSitePremium?"SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINK":l),shouldTranslate:!1,actionCallback:this.panelAction,subtitle:i.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE2")};return t.campaigns.personalSale.isActiveCampaign()&&!this.props.isSitePremium&&e.assign(n,{symbolName:"connectDomain_50",className:"personal-sale-campaign",subtitle:e.template(i.translate("SAVE_PUBLISH_WHATS_NEXT_PERSONAL_SALE_TEXT_DYNAMIC"))({discount:"50"})}),n},panelAction:function(){this.props.actionCallback&&this.props.actionCallback(),this.props.closePanel();this.isSiteBeingConnectedToDomain()?this.openConnectDomainInProgressPanel():!this.props.isDomainConnected&&this.props.isSitePremium?this.getEditorAPI().account.openConnectDomain(this.props.flowId):this.getEditorAPI().account.upgrade(this.getUpgradeReferralCode())},getUpgradeReferralCode:function(){var e="edhtml_";switch(this.props.flowId){case o.CONNECT_DOMAIN.FLOWS.PUBLISH:e+="PUBLISH_FLOW_"+(this.props.isFirstPublish?"FIRST_PUBLISH":"SECOND_PUBLISH");break;case o.CONNECT_DOMAIN.FLOWS.SAVE:e+="SAVE_FLOW_SECOND_SAVE_AND_PUBLISHED";break;default:e=null}return e},isSiteBeingConnectedToDomain:function(){return this.isUnconnectedDomainPremium()&&!e.isEmpty(this.props.sitePublishedDomain)&&!e.includes(this.props.sitePublishedDomain,"wix.com")},isUnconnectedDomainPremium:function(){return!this.props.isDomainConnected&&this.props.isSitePremium},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.connectDomainInProgress",{connectedDomainURL:this.props.sitePublishedDomain,currentPublicURL:this.props.currentDomain},!0)},render:a})}),define("savePublish/panels/content/publishContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,t.assign({},{className:this.getClassName()},this.getGeneralContentProps()))}}),define("savePublish/panels/content/publishContent",["create-react-class","prop-types","core","savePublish/panels/content/publishContent.rt"],function(e,t,n,s){"use strict";return e({displayName:"publishContent",mixins:[n.mixins.editorAPIMixin],propTypes:{closePanel:t.func.isRequired,publishMethod:t.func.isRequired,className:t.string,actionCallback:t.func},getClassName:function(){return"publish-site-content"+(this.props.className?" "+this.props.className:"")},getGeneralContentProps:function(){return{symbolName:"publishSite",mainTitle:"SAVE_SITE_SAVED_WHATS_NEXT_LABEL",title:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINE",actionLabel:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",actionCallback:this.publishSite}},publishSite:function(){this.props.closePanel(),this.props.publishMethod(),this.props.actionCallback&&this.props.actionCallback()},render:s})}),define("savePublish/panels/save/siteWasSavedPanel",["react","create-react-class","prop-types","lodash","core","coreBi","util","stateManagement","savePublish/constants/constants","savePublish/constants/savePublishErrorPanelData","savePublish/panels/save/siteWasSavedPanel.rt","savePublish/panels/content/connectDomain","constants","savePublish/panels/content/publishContent","experiment"],function(e,t,n,s,i,a,o,r,l,c,u,p,h,m,d){"use strict";function _(e){var t=e.lastIndexOf("/");return{prefix:e.slice(0,t+1),siteName:e.slice(t+1)}}var S={PUBLISH:"PUBLISH",CONNECT_DOMAIN:"CONNECT_DOMAIN"};return t({displayName:"siteWasSavedPanel",mixins:[e.addons.LinkedStateMixin,i.mixins.editorAPIMixin],propTypes:{domain:n.string.isRequired,isSitePremium:n.bool,isFirstSave:n.bool,isDomainConnected:n.bool,isSitePublished:n.bool,isMockSave:n.bool,overrideTitle:n.string,overrideSubtitle:n.string,panelName:n.string,callback:n.func},getInitialState:function(){var e={isContinueDisabled:!1,doNotShowAgain:null,domain:this.props.domain};return this.props.isFirstSave||(e.doNotShowAgain=!!r.editorPlugins.userPreferences.selectors.getSessionUserPreferences(h.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)(this.getEditorAPI().store.getState())),e},getPanelTitle:function(){return o.translate(this.props.overrideTitle||"SAVE_SITE_SAVED_TITLE_TITLE")},getPanelSubtitle:function(){return o.translate(this.props.overrideSubtitle||"SAVE_SITE_SAVED_TITLE_SUBTITLE")},getDomainInputProps:function(){var e=void 0,t=this.state.domain;if(!this.props.isDomainConnected){var n=_(t);e={prefix:n.prefix,value:n.siteName,isEditable:!0,domainValidator:this.getEditorAPI().siteName.validate,domainHandler:this.props.isMockSave?null:this.renameSiteAndProcessResult,onChange:this.handleDomainEditingStatusChanged}}else e={value:t,isEditable:!1};return e.biHandler=this.domainInputBiReporter,e},getInnerPanelType:function(){return this.props.isSitePublished?this.props.isDomainConnected?void 0:S.CONNECT_DOMAIN:S.PUBLISH},getInnerPanel:function(){switch(this.getInnerPanelType()){case S.PUBLISH:return m;case S.CONNECT_DOMAIN:return p}},getPanelClass:function(){var e="site-was-saved-panel",t=this.getInnerPanelClass();return e+=t?" contains-"+t:"",this.props.isSitePremium&&this.props.isSitePublished&&this.props.isDomainConnected&&(e+=" narrow-domain-input"),e+" save-publish-panel"},getInnerPanelClass:function(){switch(this.getInnerPanelType()){case S.PUBLISH:return"publish-inner-panel";case S.CONNECT_DOMAIN:return"connect-domain-inner-panel"}},getInnerPanelProps:function(){var e={sitePublishedDomain:this.props.domain,isDomainConnected:this.props.isDomainConnected,isFirstPublish:!this.props.isSitePublished,isSitePremium:this.props.isSitePremium,isFirstSave:this.props.isFirstSave,flowId:h.CONNECT_DOMAIN.FLOWS.SAVE,closePanel:this.close},t=this.getInnerPanelType(),n=this.getEditorAPI();switch(t){case S.PUBLISH:e.publishMethod=this.props.isMockSave?n.publishManager.configureMockPostPublish:n.publishManager.publish,this.props.isMockSave||(e.actionCallback=function(){this.reportPublishClickedBI(),this.getEditorAPI().bi.event(a.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"})}.bind(this));break;case S.CONNECT_DOMAIN:this.props.isMockSave||(e.actionCallback=this.reportConnectDomainClickedBI)}return e},shouldDisplayInnerPanel:function(){return!this.props.isSitePublished||!this.props.isDomainConnected},continueToPublish:function(){o.fedopsLogger.interactionStarted(o.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),this.props.isMockSave||(this.getEditorAPI().bi.event(a.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"}),this.reportBIWithUserStatus(a.events.save.siteWasSavedPanel.SECOND_SAVE_PUBLISH_NOW_BUTTON_CLICKED)),this.close(),this.getEditorAPI().publishManager.publish()},continueEditing:function(){if(this.props.isMockSave||(this.props.isFirstSave?this.getEditorAPI().bi.event(a.events.save.siteWasSavedPanel.FIRST_SAVE_ACTION_BUTTON_CLICKED,{}):this.reportBIWithUserStatus(a.events.save.siteWasSavedPanel.SECOND_SAVE_ACTION_BUTTON_CLICKED)),this.state.isContinueDisabled)throw new Error("Should not get to continueEditing if continue button is disabled");this.state.doNotShowAgain&&(d.isOpen("se_postSavePublishPreference")?this.getEditorAPI().store.dispatch(r.editorPlugins.userPreferences.actions.setSiteUserPreferences(h.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,Date.now())):this.getEditorAPI().store.dispatch(r.editorPlugins.userPreferences.actions.setSessionUserPreferences(h.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,this.state.doNotShowAgain))),this.close()},reportBIWithUserStatus:function(e){var t={user_status:this.getUserStatus()};this.getEditorAPI().bi.event(e,t)},getUserStatus:function(){var e="";return this.props.isSitePublished||(e+="not_"),e+="published_",this.props.isDomainConnected||(e+="not_"),e+="connected"},renameSiteAndProcessResult:function(e,t,n){var i=this.getEditorAPI();i.siteName.rename(e,function(){t()},function(e){var t=e&&e.errorCode;if(t===l.RENAME.ERRORS.SITE_NAME_TAKEN)n("SAVE_SITE_NAME_ALREADY_EXISTS");else{n();var a=s.chain(c.NAME_SITE_AGAIN_PANEL_DATA).clone().defaults(c.SAVE_ERROR_DEFAULT_PANEL_DATA).assign({errorCode:t}).value();i.panelManager.openPanel("savePublish.panels.common.failPanel",a,!0)}})},handleDomainEditingStatusChanged:function(e){var t={};if(e){var n=_(this.props.domain).prefix;t.isContinueDisabled=!1,t.domain=n+e}else t.isContinueDisabled=!0;this.setState(t)},handleNeedHelpConnectingDomainClicked:function(){this.getEditorAPI().bi.event(a.events.save.siteWasSavedPanel.HELP_CONNECTING_DOMAIN_CLICKED,{})},handleDontShowAgainClicked:function(e){this.setState({doNotShowAgain:e}),this.getEditorAPI().bi.event(a.events.save.siteWasSavedPanel.SECOND_SAVE_DONT_SHOW_AGAIN_CLICKED,{toggle:e,user_status:this.getUserStatus()})},reportPublishClickedBI:function(){this.getEditorAPI().bi.event(a.events.save.siteWasSavedPanel.PUBLISH_NOW_CLICKED,{user_status:this.getUserStatus(),is_first_save:this.props.isFirstSave?1:0})},reportConnectDomainClickedBI:function(){this.getEditorAPI().bi.event(a.events.save.siteWasSavedPanel.SECOND_SAVE_CONNECT_DOMAIN_CLICKED,{user_status:this.getUserStatus()})},domainInputBiReporter:function(e){if(!this.props.isMockSave){var t={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:this.props.isFirstSave?1:0};this.getEditorAPI().bi.event(a.events.domainInput[e],t)}},componentWillUnmount:function(){this.props.callback&&this.props.callback()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.state.isContinueDisabled||e.continueEditing()},esc:function(){e.close()}}},render:u})}),define("savePublish/panels/save/concurrentSavePanel.rt",["react","lodash","panels","baseUI","symbols","util"],function(e,t,n,s,i,a){"use strict";return function(){return e.createElement(n.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"concurrent-save-panel save-publish-panel",panelTitle:a.translate(this.getTitle()),keyboardShortcuts:this.getKeyboardShortcuts(),confirmLabel:this.getConfirmLabel(),cancelLabel:this.getCancelLabel(),onConfirm:this.overrideSave,onCancel:this.handleCancel,onClose:this.close},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"error-logo"},e.createElement(s.symbol,{name:"plaster"})),this.isAutosave()?null:e.createElement("div",{key:"withoutAutosave",className:"description-wrapper"},e.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:a.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1")}}),e.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:a.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2")}})),this.isAutosave()?e.createElement("div",{key:"withAutosave",className:"description-wrapper"},e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[0])}}),e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[1])}}),e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[2])}})):null))}}),define("savePublish/panels/save/concurrentSavePanel",["create-react-class","prop-types","core","savePublish/panels/save/concurrentSavePanel.rt","coreBi","coreUtilsLib"],function(e,t,n,s,i,a){"use strict";return e({displayName:"concurrentSavePanel",mixins:[n.mixins.editorAPIMixin],propTypes:{overrideSaveMethod:t.func.isRequired,onCancel:t.func,panelName:t.string,origin:t.string},isAutosave:function(){return"autosave"===this.props.origin},getTitle:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_TITLE":"SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_TITLE"},getBodyText:function(){return this.isAutosave()?["AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_HEADER","AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_OPTION1","AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_OPTION2"]:["SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1","SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2"]},getConfirmLabel:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_BUTTON_LABEL":"SAVE_ERROR_CONCURRENT_EDITING_SAVE_BUTTON"},getCancelLabel:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_LINK_LABEL":"SAVE_ERROR_CONCURRENT_EDITING_DONT_SAVE_BUTTON"},overrideSave:function(){this.props.overrideSaveMethod?(this.props.overrideSaveMethod(this.getEditorAPI),this.sendBI("save")):a.log.info("Mock Overriding Save"),this.close()},handleCancel:function(){this.props.overrideSaveMethod&&this.sendBI(this.isAutosave()?"update":"don't save"),this.close(),this.props.onCancel&&this.props.onCancel()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},sendBI:function(e){var t=i.events.save.saveFailed,n=this.isAutosave()?t.CONCURRENT_AUTOSAVE:t.CONCURRENT_SAVE;this.getEditorAPI().bi.event(n,{selection:e})},getKeyboardShortcuts:function(){var e=this;return{esc:function(){e.close()}}},render:s})}),define("savePublish/panels/save/saveConfigurationPanel.rt",["react","lodash","panels","baseUI","baseUILib"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(n.frames.emptyPanelFrame,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({ref:"frame",className:"save-configuration-panel"},this.getFrameProps()),e.createElement("a",{className:"close-button",onClick:this.close},"x"),e.createElement("h2",{style:{textAlign:"center"}},"Save Testing Configuration"),e.createElement(i.Checkbox,{className:"checkbox-field",label:"First save",valueLink:this.linkState("isFirstSave"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Save succeeds",valueLink:this.linkState("shouldSaveSucceed"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement("p",{},e.createElement("br",{}),"Premium Interaction:"),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Site is/upgraded-to premium",value:this.state.isSitePremium,onChange:this.premiumToggled,shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Domain is/will-be connected",value:this.state.isDomainConnected,onChange:this.domainConnectedToggled,shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(s.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Custom Domain",valueLink:this.linkState("domain"),disabled:!this.state.isDomainConnected}),e.createElement(i.Checkbox,{className:"checkbox-field"+(this.state.isFirstSave?" disabled":""),label:"Site is published",valueLink:this.linkState("isSitePublished"),disabled:this.state.isFirstSave,shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement("button",{className:"concurrent-save-button",shouldTranslate:!1,onClick:this.openConcurrentSave},"Concurrent Save"),e.createElement("button",{className:"save-reminder-button",shouldTranslate:!1,onClick:this.openSaveReminder},"Save Reminder"),e.createElement("div",{className:"save-configuration-footer"},e.createElement(s.button,{className:"confirm-button",shouldTranslate:!1,label:"Start Save",onClick:this.onConfirm})))}}),define("savePublish/panels/save/saveConfigurationPanel",["react","create-react-class","prop-types","core","savePublish/panels/save/saveConfigurationPanel.rt","coreUtilsLib"],function(e,t,n,s,i,a){"use strict";return t({displayName:"SaveConfigurationPanel",mixins:[e.addons.LinkedStateMixin,s.mixins.editorAPIMixin],propTypes:{onConfirm:n.func.isRequired,panelName:n.string},getInitialState:function(){return{isSitePremium:!1,isFirstSave:!0,isDomainConnected:!1,domain:"http://www.my-domain.com",isSitePublished:!1,shouldSaveSucceed:!0}},getFrameProps:function(){return{panelName:this.props.panelName}},openConcurrentSave:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.save.concurrentSavePanel",{overrideSaveMethod:function(){a.log.info("Override Save")}},!0)},openSaveReminder:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.save.saveReminderPanel",{saveMethod:this.onConfirm},!0)},componentWillUpdate:function(e,t){t.isFirstSave&&t.isSitePublished&&this.setState({isSitePublished:!1,isFirstSave:!0})},premiumToggled:function(){var e=!this.state.isSitePremium;this.setState({isSitePremium:e,isDomainConnected:!!e&&this.state.isDomainConnected})},domainConnectedToggled:function(){var e=!this.state.isDomainConnected;this.setState({isDomainConnected:e,isSitePremium:e||this.state.isSitePremium})},onConfirm:function(){this.props.onConfirm({isSitePremium:this.state.isSitePremium,isFirstSave:this.state.isFirstSave,isDomainConnected:this.state.isDomainConnected,domain:this.state.domain,isSitePublished:this.state.isSitePublished,shouldSaveSucceed:this.state.shouldSaveSucceed})},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/saveReminderPanel.rt",["react","lodash","util","baseUI","panels","experiment"],function(e,t,n,s,i,a){"use strict";return function(){return a.isOpen("disableSaveReminder")?null:e.createElement(i.frames.messagePanelFrame,{ref:"frame",key:"saveReminder",panelName:this.props.panelName,className:"save-reminder-panel save-publish-panel",panelTitle:n.translate("SAVE_REMINDER_MSG_TITLE"),confirmLabel:"SAVE_REMINDER_MSG_BUTTON",onConfirm:this.handleSave,keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"icon"},e.createElement(s.symbol,{name:"saveYourWork"})),e.createElement("div",{className:"message"},n.translate("SAVE_REMINDER_MSG_BODY"))))}}),define("savePublish/panels/save/saveReminderPanel",["create-react-class","prop-types","lodash","core","coreBi","savePublish/panels/save/saveReminderPanel.rt"],function(e,t,n,s,i,a){"use strict";return e({displayName:"saveReminderPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{saveMethod:t.func.isRequired,panelName:t.string},componentWillMount:function(){this.getEditorAPI().bi.event(i.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"pop up message"})},handleSave:function(){this.getEditorAPI().bi.event(i.events.save.saveReminder.SAVE_CLICKED,{}),this.close(),this.props.saveMethod()},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.close(),e.handleSave()},esc:function(){e.close()}}},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:a})}),define("savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(e,t,n,s){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{ref:"frame",key:"onBoardingMigrationConfirmationPanel",shouldHideHelp:!0,className:"save-on-boarding-site-confirm-panel",title:this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TITLE"),panelName:this.props.panelName},e.createElement("div",{className:"save-on-boarding-site-confirm-content"},e.createElement("div",{className:"image-container"},e.createElement(s.symbol,{name:"obMigrationBeforeSave"})),e.createElement("div",{className:"description-container"},e.createElement("span",{className:"description-text"},this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TEXT"))),e.createElement("div",{className:"footer-buttons"},e.createElement(s.button,{onClick:this.navigateToOnBoarding,className:"btn-confirm-secondary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BUTTON_ADI"}),e.createElement(s.button,{onClick:this.saveDocument,className:"btn-confirm-primary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BTN_SAVE"}))))}}),define("savePublish/panels/save/onBoardingMigrationConfirmationPanel",["create-react-class","prop-types","util","core","coreBi","savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt"],function(e,t,n,s,i,a){"use strict";function o(e,t){e.bi.event(i.events.ON_BOARDING_MIGRATION.PANEL_ACTION_CLICKED,{action:t})}var r={NAVIGATE_TO_OB:"Go Back to Wix ADI",SAVE:"Save Changes"};return e({displayName:"onBoardingMigrationConfirmationPanel",propTypes:{panelName:t.string.isRequired,onConfirm:t.func.isRequired,onCancel:t.func},mixins:[n.translationMixin,s.mixins.editorAPIMixin],saveDocument:function(){o(this.getEditorAPI(),r.SAVE),this.props.onConfirm(),this.close()},navigateToOnBoarding:function(){this.props.onCancel(),o(this.getEditorAPI(),r.NAVIGATE_TO_OB),window.location=n.editorModel.onboardingEditorUrl},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:a})}),define("savePublish/panels/save/saveYourSitePanel.rt",["react","lodash","util","baseUI","panels"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(i.frames.messagePanelFrame,{ref:"frame",panelName:this.props.panelName,className:"save-your-site-panel",panelTitle:n.translate(this.props.title),confirmLabel:"TOPBAR_SETTINGS_BUTTON_SAVE",onConfirm:this.handleSave,keyboardShortcuts:this.keyboardShortcuts},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"logo"},e.createElement(s.symbol,{name:"saveYourWork"})),e.createElement("div",{className:"message"},n.translate(this.props.messageBody))))}}),define("savePublish/panels/save/saveYourSitePanel",["create-react-class","prop-types","lodash","core","savePublish/panels/save/saveYourSitePanel.rt"],function(e,t,n,s,i){"use strict";return e({displayName:"saveYourSitePanel",mixins:[s.mixins.editorAPIMixin],propTypes:{title:t.string.isRequired,panelName:t.string,messageBody:t.string.isRequired},getInitialState:function(){return this.keyboardShortcuts={enter:this.handleSave,esc:this.close},{}},handleSave:function(){this.close();this.getEditorAPI().saveManager.save()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/savePanels",["savePublish/panels/save/chooseDomainPanel","savePublish/panels/save/siteWasSavedPanel","savePublish/panels/save/concurrentSavePanel","savePublish/panels/save/saveConfigurationPanel","savePublish/panels/save/saveReminderPanel","savePublish/panels/save/onBoardingMigrationConfirmationPanel","savePublish/panels/save/saveYourSitePanel"],function(e,t,n,s,i,a,o){"use strict";return{chooseDomainPanel:e,siteWasSavedPanel:t,concurrentSavePanel:n,saveConfigurationPanel:s,saveReminderPanel:i,onBoardingMigrationConfirmationPanel:a,saveYourSitePanel:o}}),define("savePublish/panels/publish/config/publishConfigurationPanel.rt",["react","lodash","panels","baseUI","baseUILib"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(n.frames.emptyPanelFrame,{className:"save-configuration-panel",panelName:this.props.panelName},e.createElement("a",{className:"close-button",onClick:this.close},"x"),e.createElement("h2",{style:{textAlign:"center"}},"Publish Testing Configuration"),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Is Contributor to site",valueLink:this.linkState("isSiteContributor"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Did Publish Succeed",valueLink:this.linkState("shouldPublishSucceed"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Site is Premium",valueLink:this.linkState("isPremiumUser"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"First Publish",valueLink:this.linkState("isFirstPublish"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Is Domain Connected",valueLink:this.linkState("isDomainConnected"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(s.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Site address (Domain Name)",valueLink:this.linkState("sitePremiumDomain")}),e.createElement(s.button,{className:"confirm-button",disabled:!this.state.isPremiumUser&&this.state.isDomainConnected&&this.state.shouldPublishSucceed,shouldTranslate:!1,label:"Start Publish",onClick:this.onConfirm}))}}),define("savePublish/panels/publish/config/publishConfigurationPanel",["react","create-react-class","prop-types","core","savePublish/panels/publish/config/publishConfigurationPanel.rt"],function(e,t,n,s,i){"use strict";return t({displayName:"publishConfigurationPanel",mixins:[e.addons.LinkedStateMixin,s.mixins.editorAPIMixin],propTypes:{onConfirm:n.func.isRequired,panelName:n.string},getInitialState:function(){return{isSiteContributor:!1,isFirstPublish:!0,isDomainConnected:!1,isPremiumUser:!0,shouldPublishSucceed:!0,sitePremiumDomain:"http://www.published-site-domain.com"}},onConfirm:function(){this.props.onConfirm({isSiteContributor:this.state.isSiteContributor,isFirstPublish:this.state.isFirstPublish,isDomainConnected:this.state.isDomainConnected,sitePremiumDomain:this.state.sitePremiumDomain,isPremiumUser:this.state.isPremiumUser,shouldPublishSucceed:this.state.shouldPublishSucceed})},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/publish/content/postPublishPromotePanel.rt",["react","lodash","baseUILib","baseUI"],function(e,t,n,s){"use strict";return function(){return e.createElement("div",{className:"panel-shout-out"},e.createElement("div",{className:"promote-title-wrapper"},e.createElement(n.Divider,{long:!0}),e.createElement("div",{className:"promote-title"},this.getTitle()),e.createElement(n.Divider,{long:!0})),e.createElement.apply(this,["div",{className:"promotion-content"},t.map(this.getPanelContent(),function(t,n){return e.createElement("div",{className:"promote"},t.symbol?e.createElement("div",{key:"promotionSymbol-"+t.key,className:"promote-symbol promote-symbol-"+t.key},e.createElement(s.symbol,{name:t.symbol})):null,t.img&&!t.symbol?e.createElement("div",{key:"promotionImg-"+t.key,className:"promote-image",style:{backgroundImage:"url("+t.img+")"}}):null,e.createElement("div",{className:"description"},t.description),e.createElement("a",{onClick:t.action},t.actionTitle))}.bind(this))]))}}),define("savePublish/panels/publish/content/shoutoutPanel",["lodash","create-react-class","prop-types","core","util","experiment","coreBi","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(e,t,n,s,i,a,o,r){"use strict";return t({displayName:"shoutoutPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{isUserPremium:n.bool,languageCode:n.string,metaSiteId:n.string.isRequired,sitePublicUrl:n.string,siteNameSEO:n.string,siteDescriptionSEO:n.string,isFirstPublish:n.bool,userStatus:n.string},getTitle:function(){return i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_TITLE")},getPanelContent:function(){var e={key:"facebook",symbol:"publishFacebook",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_LINK"),action:this.openFacebook},t={key:"seo",symbol:"publishSeo",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_LINK"),action:this.openSeoWizard},n={key:"twitter",symbol:"publishTwitter",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_LINK"),action:this.openTwitter},s={key:"shoutout",symbol:"publishShoutout",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_LINK"),action:this.openShoutout};return this.getEditorAPI().account.isWixSEOWizExperimentOpen()&&a.isOpen("se_seoWizard")?[t,n,s]:[e,n,s]},openFacebook:function(){this.sendSecondPublishBI(o.events.publish.Second_Publish_facebook_Share_click),s.utils.social.openFacebook(this.props.sitePublicUrl,this.props.languageCode,this.props.siteNameSEO,this.props.siteDescriptionSEO)},openSeoWizard:function(){this.sendSecondPublishBI(o.events.publish.Second_Publish_Seo_Wizard_click),this.getEditorAPI().account.openWixSEOWiz("EDITOR_POSTPUBLISH")},openTwitter:function(){this.sendSecondPublishBI(o.events.publish.Second_Publish_Twitter_share_click),s.utils.social.openTwitter(this.props.sitePublicUrl,this.props.isUserPremium)},openShoutout:function(){this.sendSecondPublishBI(o.events.publish.Second_Publish_ShoutOut_Share_click),s.utils.social.openShoutout(this.props.metaSiteId)},sendSecondPublishBI:function(e){!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(e,{user_status:this.props.userStatus})},render:r})}),define("savePublish/panels/publish/content/growBusinessPanel",["create-react-class","prop-types","core","util","experiment","coreBi","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(e,t,n,s,i,a,o){"use strict";return e({displayName:"growBusinessPanel",mixins:[n.mixins.editorAPIMixin],propTypes:{metaSiteId:t.string.isRequired,isFirstPublish:t.bool,userStatus:t.string},getTitle:function(){return s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_TITLE")},getPanelContent:function(){var e={key:"seo",symbol:"publishSeo",description:s.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_LINK"),action:this.openSeoWizard},t={key:"newsletter",symbol:"publishShoutout",description:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_LINK"),action:this.openShoutout},n={key:"mail",symbol:"promoteMail",description:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_LINK"),action:this.getYourOwnMailbox},a={key:"traffic",symbol:"promoteContact",description:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_LINK"),action:this.getTrafficApps};return i.isOpen("newPublishPanel")?[t,n,e]:[t,n,a]},openSeoWizard:function(){this.props.userStatus&&this.getEditorAPI().bi.event(a.events.publish.Second_Publish_Seo_Wizard_click,{user_status:this.props.userStatus}),this.getEditorAPI().account.openWixSEOWiz("EDITOR_POSTPUBLISH_PREMIUM")},openShoutout:function(){this.sendPublishBI(a.events.publish.First_Publish_Send_ShoutOut_link_click,a.events.publish.Second_Publish_ShoutOut_Share_click),n.utils.social.openShoutout(this.props.metaSiteId)},getYourOwnMailbox:function(){this.sendPublishBI(a.events.publish.First_Publish_get_own_Mailbox_link_click,a.events.publish.Second_Publish_get_own_Mailbox_click),window.open("https://premium.wix.com/wix/api/googleMailBoxConsole?referralAdditionalInfo=da_quick_actions")},getTrafficApps:function(){this.sendPublishBI(a.events.publish.First_Publish_Traffic_Apps_link_click,a.events.publish.Second_Publish_Traffic_Apps_click);var e=["//www.wix.com/my-account/sites/",this.props.metaSiteId,"/apps/all?referralInfo=premium_publish"].join("");window.open(e)},sendPublishBI:function(e,t){this.props.isFirstPublish&&this.props.userStatus?this.getEditorAPI().bi.event(e,{user_status:this.props.userStatus}):!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(t,{user_status:this.props.userStatus})},render:o})}),define("savePublish/panels/content/musicPromoContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:"music-promo-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/musicPromoContent",["create-react-class","prop-types","lodash","core","util","staticAssets","coreBi","savePublish/panels/content/musicPromoContent.rt"],function(e,t,n,s,i,a,o,r){"use strict";return e({displayName:"musicPromoContent",propTypes:{className:t.string,closePanel:t.func.isRequired},mixins:[s.mixins.editorAPIMixin],getGeneralContentProps:function(){var e=void 0,t=void 0;i.browserUtil.getDevicePixelRatio()>=2?(e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/musicPromotionRetina.png"]),t={width:110.5}):e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/musicPromotion.png"]);return{className:"",imageSrc:e,imageStyle:t,mainTitle:i.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_TITLE"),subtitle:i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BODY1"),actionLabel:i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON"),shouldTranslate:!1,actionCallback:this.handleActionClicked}},handleActionClicked:function(){var e=o.events.musicPromotionPopup.submit_video_clicked;this.getEditorAPI().bi.event(e,{origin:"post-publish-link"});var t=i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON_URL");this.props.closePanel(),window.open(t)},render:r})}),define("savePublish/panels/content/photographyPromoContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:"photo-promo-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/photographyPromoContent",["create-react-class","prop-types","lodash","core","util","staticAssets","coreBi","savePublish/panels/content/photographyPromoContent.rt"],function(e,t,n,s,i,a,o,r){"use strict";return e({displayName:"photographyPromoContent",propTypes:{className:t.string,closePanel:t.func.isRequired},mixins:[s.mixins.editorAPIMixin],getGeneralContentProps:function(){var e=void 0,t=void 0;return i.browserUtil.getDevicePixelRatio()>=2?(e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/photoPromotionRetina.gif"]),t={width:"100%"}):e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/photoPromotion.gif"]),{className:"",imageSrc:e,imageStyle:t,mainTitle:i.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:i.translate("PHOTO_PROMO_PUBLISH_HEADER"),subtitle:i.translate("PHOTO_PROMO_PUBLISH_TEXT"),actionLabel:i.translate("PHOTO_PROMO_PUBLISH_CTA"),shouldTranslate:!1,actionCallback:this.handleActionClicked}},handleActionClicked:function(){var e=o.events.photographyPromotionPopup.submit_video_clicked;this.getEditorAPI().bi.event(e,{origin:"post-publish-link"});var t=i.translate("PHOTO_PROMO_PUBLISH_CTA_URL");this.props.closePanel(),window.open(t)},render:r})}),define("savePublish/panels/publish/publishSuccessPanel.rt",["react","lodash","panels","util","baseUI","baseUILib","symbols"],function(e,t,n,s,i,a,o){"use strict";return function(){function r(){var r=this.getInnerPanel();return e.createElement(n.frames.focusPanelFrame,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:this.getFrameClass(),frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},this.getFrameProps()),e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:this.props.closePanel},e.createElement(o.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},s.translate("PUBLISH_CONGRATULATIONS_TITLE_TITLE")),e.createElement("span",{className:"subtitle"},s.translate("PUBLISH_CONGRATULATIONS_TITLE_SUBTITLE"))),e.createElement("div",{className:"address-bar-wrapper"},e.createElement("span",{className:"address"},e.createElement(i.domainInput,{value:this.getSiteUrl(),isEditable:!1,biHandler:this.domainInputBiReporter})),e.createElement(i.button,{className:"view-site-button",label:"SAVE_PUBLISH_BUTTON_VIEW",onClick:this.viewYourSite})),null!==r?e.createElement("div",{key:"innerPanel",className:"publish-inner-panel"},r):null,e.createElement("div",{className:"publish-success-footer"},this.isDontShowAgainCheckboxVisible()&&null!==r?e.createElement(a.Checkbox,{key:"dontShowAgain",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",value:this.state.dontShowAgain,onChange:this.toggleDontShowAgain,labelAfterSymbol:!0}):null,e.createElement("div",{className:"footer-buttons"},this.isSecondaryButtonDisplayed()?e.createElement(i.button,{key:"secondaryFooterButton",className:"btn-confirm-secondary",label:this.getSecondaryButtonText(),onClick:this.handleSecondaryButtonClicked}):null,e.createElement(i.button,{className:"btn-confirm-primary",label:this.getPrimaryButtonText(),onClick:this.handlePrimaryButtonClicked}))))}return r.apply(this,[])}}),define("savePublish/panels/publish/publishSuccessPanel",["react","create-react-class","lodash","prop-types","core","stateManagement","savePublish/panels/publish/publishInnerPanelTypes","savePublish/panels/publish/content/shoutoutPanel","savePublish/panels/publish/content/growBusinessPanel","savePublish/panels/content/connectDomain","savePublish/panels/content/musicPromoContent","savePublish/panels/content/photographyPromoContent","savePublish/panels/publish/publishSuccessPanel.rt","coreBi","constants","experiment"],function(e,t,n,s,i,a,o,r,l,c,u,p,h,m,d,_){"use strict";var S=a.editorPlugins.domain.selectors;return t({displayName:"publishSuccessPanel",mixins:[e.addons.LinkedStateMixin,i.mixins.editorAPIMixin],propTypes:{isFakePanel:s.bool,contentPanelType:function(e,t,s){if(!e[t]||!n.some(o,e[t]))return new Error("Invalid prop `"+t+"` supplied to "+s+". Validation failed.")},configuration:s.object.isRequired,currentDomain:s.string.isRequired,setDontShowPanelValue:s.func.isRequired,sitePublicUrl:s.string.isRequired,closePanel:s.func.isRequired,panelName:s.string},componentDidMount:function(){this.sendPanelMountedBI()},getInitialState:function(){return{dontShowAgain:!1}},getShortcuts:function(){return{esc:this.onClose,enter:this.handlePrimaryButtonClicked}},onClose:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getFrameProps:function(){return{panelName:this.props.panelName,shouldHideHeader:!0}},getInnerContentClass:function(){if(this.props.contentPanelType===o.EMPTY)return null;switch(this.props.contentPanelType.name){case o.SHOUTOUT.name:return"grow-business-inner-panel";case o.CONNECT_DOMAIN.name:return"connect-domain-inner-panel";case o.GROW_BUSINESS.name:return"grow-business-inner-panel";case o.MUSIC_PROMO.name:return"music-promo-inner-panel";case o.PHOTOGRAPHY_PROMO.name:return"photo-promo-inner-panel";default:return""}},getFrameClass:function(){var e="publish-success-panel save-publish-panel",t=this.getInnerContentClass();return e+=t?" contains-"+t:""},onDoneAndBI:function(e){this.sendActionButtonClickedBI(e),this.onDone()},onDone:function(){if(this.state.dontShowAgain||this.props.isFakePanel){var e=this.state.dontShowAgain;this.props.setDontShowPanelValue(e)}this.props.closePanel()},isDontShowAgainCheckboxVisible:function(){return!this.props.configuration.isFirstPublish&&!n.isEqual(this.props.contentPanelType,o.EMPTY)},isSecondaryButtonDisplayed:function(){return _.isOpen("publishUpgradeButtons")&&!this.props.configuration.isDomainConnected&&this.props.contentPanelType.name===o.CONNECT_DOMAIN.name},viewYourSite:function(){this.sendViewSiteBI();var e=this.getEditorAPI().site.getSitePublicUrl();this.props.configuration.isDomainConnected&&(e=this.props.configuration.sitePremiumDomain),window.open(e)},getSiteUrl:function(){var e=this.getEditorAPI(),t=e.store.getState(),n=S.getSiteProtocol(t,e.documentServices),s=S.isDomainConnected(t,e.documentServices);return(this.props.configuration.sitePremiumDomain||this.props.sitePublicUrl).replace(/(?:^https?:\/\/)?(?:www\.)?(.*)/i,n+(s?"://www.$1":"://$1"))},getInnerPanel:function(){if(this.props.contentPanelType===o.EMPTY)return null;var t=null,n=null;switch(this.props.contentPanelType.name){case o.SHOUTOUT.name:t=r,n=this.getShoutoutPanelProps();break;case o.CONNECT_DOMAIN.name:t=c,n=this.getConnectDomainPanelProps(this.props.configuration);break;case o.GROW_BUSINESS.name:t=l,n={metaSiteId:this.getEditorAPI().documentServices.generalInfo.getMetaSiteId(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish};break;case o.MUSIC_PROMO.name:t=u,n={closePanel:this.onDone};break;case o.PHOTOGRAPHY_PROMO.name:t=p,n={closePanel:this.onDone}}return t?e.createElement(t,n):null},getShoutoutPanelProps:function(){var e=this.getEditorAPI();return{isUserPremium:this.props.configuration.isPremiumUser,languageCode:e.getLanguageCode(),metaSiteId:e.documentServices.generalInfo.getMetaSiteId(),sitePublicUrl:this.props.sitePublicUrl,siteNameSEO:e.documentServices.seo.title.get(),siteDescriptionSEO:e.documentServices.seo.description.get(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish}},getConnectDomainPanelProps:function(e){return{isFirstPublish:e.isFirstPublish,isDomainConnected:e.isDomainConnected,currentDomain:this.props.sitePublicUrl,sitePublishedDomain:e.sitePremiumDomain,isSitePremium:e.isPremiumUser,isFirstSave:e.isFirstSave,closePanel:this.onDone,flowId:d.CONNECT_DOMAIN.FLOWS.PUBLISH,actionCallback:this.sendConnectDomainClickedBI}},getPrimaryButtonText:function(){return this.isSecondaryButtonDisplayed()?this.props.configuration.isPremiumUser?"Save_Publish_POST_CONNECT_NOW":(_.isOpen("spanishUpgradeText"),"Save_Publish_POST_UPGRADE_NOW"):"SAVE_PUBLISH_BUTTON_DONE"},getSecondaryButtonText:function(){return"Save_Publish_POST_CONNECT_LATER"},handlePrimaryButtonClicked:function(){var e=this.props.configuration.isFirstPublish,t=m.events.publish,n=e?t.First_Publish_Done_click:t.Second_Publish_Done_click;if(this.isSecondaryButtonDisplayed())if(this.isConnectDomainInProgress())this.openConnectDomainInProgressPanel(),n=t.publish_flow_connect_domain_now_button_click;else if(this.props.configuration.isPremiumUser)this.getEditorAPI().account.openConnectDomain(d.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON,e),n=t.publish_flow_connect_domain_now_button_click;else{var s="edhtml_PUBLISH_FLOW_UPGRADE_BUTTON_"+(e?"FIRST_PUBLISH":"SECOND_PUBLISH");this.getEditorAPI().account.upgrade(s),n=t.publish_flow_upgrade_now_button_click}this.onDoneAndBI(n)},handleSecondaryButtonClicked:function(){var e=this.props.configuration.isFirstPublish,t=m.events.publish,n=e?t.First_Publish_Done_click:t.Second_Publish_Done_click;this.isSecondaryButtonDisplayed()&&(n=this.props.configuration.isPremiumUser?t.publish_flow_connect_domain_later_button_click:t.publish_flow_upgrade_later_button_click),this.onDoneAndBI(n)},isConnectDomainInProgress:function(){var e=this.props.configuration.sitePremiumDomain,t=this.props.configuration.isDomainConnected,s=this.props.configuration.isPremiumUser,i=!n.isEmpty(e)&&!n.includes(e,"wix.com");return s&&i&&!t},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.connectDomainInProgress",{connectedDomainURL:this.props.configuration.sitePremiumDomain,currentPublicURL:this.props.sitePublicUrl},!0)},sendPanelMountedBI:function(){var e=m.events.publish.publish_success_panel_opened_with_content,t={is_first_publish:this.props.configuration.isFirstPublish,message:this.props.contentPanelType.name};this.sendBI(e,t)},sendConnectDomainClickedBI:function(){var e=null,t=null;e=this.props.configuration.isFirstPublish?m.events.publish.First_Publish_connect_domain_click:m.events.publish.Second_Publish_connect_domain_click,this.props.configuration.isSitePremium&&!this.props.configuration.isDomainConnected?t={user_status:"Not Connected Premium"}:this.props.configuration.isSitePremium||(t={user_status:"free user"}),e.fields.message&&(t.message=this.props.contentPanelType.name),e&&t&&this.sendBI(e,t)},sendActionButtonClickedBI:function(e){var t=this.props.configuration.isFirstPublish,n={user_status:this.getUserStatus()};e.fields.is_first_publish&&(n.is_first_publish=t),e.fields.message&&(n.message=this.props.contentPanelType.name),this.sendBI(e,n)},sendViewSiteBI:function(){this.sendBI(m.events.publish.publish_view_your_site_click,{is_first_publish:this.props.configuration.isFirstPublish?1:0,panel_name:"savePublish.panels.publish.publishSuccessPanel",user_status:this.getUserStatus()})},getUserStatus:function(){var e=this.props.configuration.isPremiumUser,t=this.props.configuration.isDomainConnected,n=null;return e?e&&t?n="Connected Premium":e&&!t&&(n="Not Connected Premium"):n="free user",n},toggleDontShowAgain:function(){var e=!this.state.dontShowAgain;this.sendToggleDontShowAgainBI(e),this.setState({dontShowAgain:e})},sendToggleDontShowAgainBI:function(e){e=e?1:0,this.props.configuration.isFirstPublish?this.sendBI(m.events.publish.First_Publish_dont_show_again_click,{toggle:e,user_status:this.getUserStatus()}):this.sendBI(m.events.publish.Second_Publish_dont_show_again_click,{toggle:e})},domainInputBiReporter:function(e){var t={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"publish",is_first_save_or_publish:this.props.configuration.isFirstPublish?1:0};this.sendBI(m.events.domainInput[e],t)},sendBI:function(e,t){this.getEditorAPI().bi.event(e,t)},render:h})}),define("savePublish/panels/publish/publishPanels",["savePublish/panels/publish/config/publishConfigurationPanel","savePublish/panels/publish/publishSuccessPanel","savePublish/panels/publish/content/shoutoutPanel"],function(e,t,n){"use strict";return{config:{publishConfigurationPanel:e},publishSuccessPanel:t,shoutOut:n}}),define("savePublish",["lodash","savePublish/managers/saveManagerWrapper","savePublish/managers/autosaveManager","savePublish/managers/mockSaveManager","savePublish/managers/publishManager","savePublish/panels/connectDomain/connectDomainPanel","savePublish/panels/connectDomain/connectDomainInProgress","savePublish/panels/common/commonPanels","savePublish/panels/save/savePanels","savePublish/panels/publish/publishPanels"],function(e,t,n,s,i,a,o,r,l,c){"use strict";return{createSaveManager:t,createPublishManager:i,createAutosaveManager:n,configureSave:s.save,panels:{connectDomain:a,connectDomainInProgress:o,common:r,publish:c,save:l}}});
//# sourceMappingURL=savePublish.min.js.map