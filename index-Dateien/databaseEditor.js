define("databaseEditor/mixins/dbEditorApiContextMixin",["prop-types"],function(e){"use strict";return{contextTypes:{dbEditorApi:e.object.isRequired},getDbEditorApi:function(){return this.context.dbEditorApi}}}),define("databaseEditor/components/itemDetails.rt",["react","lodash","baseUI"],function(e,t,i){"use strict";return function(){return e.createElement("div",{className:"item-details",onClick:this.editItem},this.props.showImage&&this.getImageDef().imageVisible?function(){var s=this.getImageDef();return e.createElement("span",{key:"item-img-container",className:t({"item-thumb-img":!0,noImage:!s.imageValid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},s.imageValid?e.createElement("img",t.assign({},{key:"item-img-thumb"},s.props)):null,s.imageValid?null:e.createElement(i.symbol,{name:"camera",key:"item-img-symbol"}))}.apply(this,[]):null,e.createElement("span",{className:"item-title"},t.unescape(this.props.item.title)||"(Untitled Item)"))}}),define("databaseEditor/components/itemDetails",["lodash","create-react-class","prop-types","util","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemDetails.rt"],function(e,t,i,s,a,n){"use strict";return t({displayName:"itemDetails",mixins:[s.translationMixin,a],propTypes:{item:i.object.isRequired,showImage:i.bool,visibleFields:i.arrayOf(i.string)},getDefaultProps:function(){return{showImage:!0}},getImageDef:function(){var t=function(t,i){return e.find(t,function(t,s){return"wix:Image"===t._type&&e.includes(i,s)})}(this.props.item,this.props.visibleFields),i=!!t,a=i&&!e.isEmpty(t.src);return{imageVisible:i,imageValid:a,props:a?function(e,t){var i={uri:e.src,width:e.width,height:e.height},a=s.imageTransform.getData(s.imageTransform.fittingTypes.SCALE_TO_FILL,{width:i.width,height:i.height,id:i.uri},{width:43,height:43,alignment:s.imageTransform.alignTypes.CENTER,htmlTag:"img"});return{src:t.getServiceTopology().staticMediaUrl+"/"+a.uri,style:a.css.img}}(t,this.getDbEditorApi()):null}},editItem:function(){this.getDbEditorApi().setCurrentItem(this.props.item._iid,"hover_item")},render:n})}),define("databaseEditor/components/itemActionMenu.rt",["react","lodash","baseUI","experiment"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:"item-action-menu",onClick:function(e){e.stopPropagation()}.bind(this)},e.createElement("div",{className:"action-buttons-container"},e.createElement(i.button,{className:"duplicate-item-button",label:"list_dbe_hover_item_duplicate_tooltip",icon:"duplicate",onClick:this.duplicateItem}),e.createElement(i.button,{className:"delete-item-button",label:"list_dbe_hover_item_delete_tooltip",icon:"delete",onClick:this.deleteItem}),this.props.isHidden?e.createElement(i.button,{key:"hoverItemShowBtn",className:"show-item-button",label:"list_dbe_hover_item_show",icon:"quickActionsShow",onClick:this.showItem}):null,this.props.isHidden?null:e.createElement(i.button,{key:"hoverItemHideBtn",className:"hide-item-button",label:"list_dbe_hover_item_hide",icon:"quickActionsHide",onClick:this.hideItem}),e.createElement(i.button,{className:"edit-item-button",label:"list_dbe_hover_item_edit",icon:"pencil",onClick:this.editItem})))}}),define("databaseEditor/components/itemActionMenu",["create-react-class","prop-types","util","databaseEditor/components/itemActionMenu.rt","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i,s,a){"use strict";return e({displayName:"itemActionMenu",mixins:[i.translationMixin,a],propTypes:{item:t.object.isRequired,isHidden:t.bool.isRequired},editItem:function(){var e=this.props.item._iid;this.getDbEditorApi().setCurrentItem(e,"hover_item")},duplicateItem:function(){this.getDbEditorApi().duplicateItems([this.props.item],"hover_item")},deleteItem:function(){this.getDbEditorApi().deleteItems([this.props.item],"hover_item")},showItem:function(){this.getDbEditorApi().showItems([this.props.item],"hover_item")},hideItem:function(){this.getDbEditorApi().hideItems([this.props.item],"hover_item")},render:s})}),define("databaseEditor/components/itemListRow.rt",["react","lodash","baseUI","baseUILib","databaseEditor/components/itemDetails","databaseEditor/components/itemActionMenu"],function(e,t,i,s,a,n){"use strict";return function(){return e.createElement("div",function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"item-list-row"},this.filteredProps()),this.props.isOpened?null:e.createElement("span",{className:"drag-handle-container",key:"drag-handle",onMouseDown:this.props.onStartDrag},e.createElement(i.symbol,{name:"dragHandle",className:"symbol-dragHandle"})),this.props.isOpened?null:e.createElement(s.Checkbox,{key:"item-checkbox",labelAfterSymbol:!0,value:this.props.isSelected,onChange:this.props.onSelect}),e.createElement(a,{className:t({draggable:!0}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),item:this.props.item,showImage:!this.props.isOpened,visibleFields:this.props.visibleFields,isHidden:this.props.isHidden}),e.createElement(n,{item:this.props.item,isHidden:this.props.isHidden}))}}),define("databaseEditor/components/itemListRow",["create-react-class","prop-types","lodash","databaseEditor/components/itemListRow.rt","util"],function(e,t,i,s,a){"use strict";return e({displayName:"itemListRow",mixins:[a.propTypesFilterMixin],propTypes:{item:t.object.isRequired,isOpened:t.bool.isRequired,isSelected:t.bool.isRequired,visibleFields:t.arrayOf(t.string),onSelect:t.func.isRequired,onStartDrag:t.func},render:s})}),define("databaseEditor/components/noItems.rt",["react","lodash","baseUI"],function(e,t,i){"use strict";return function(){return e.createElement("div",{className:"no-items"},e.createElement(i.symbol,{name:"createYourFirstItem",className:"no-items-image"}),e.createElement("span",{className:"no-items-title"},this.translateIfNeeded("list_dbe_this_list_is_empty")),e.createElement("div",{className:"no-items-click-container"},e.createElement("span",{},this.translateIfNeeded("list_dbe_empty_sate_line2"))))}}),define("databaseEditor/components/noItems",["create-react-class","lodash","databaseEditor/components/noItems.rt","databaseEditor/mixins/dbEditorApiContextMixin","util"],function(e,t,i,s,a){"use strict";return e({displayName:"noItems",mixins:[s,a.translationMixin],render:i})}),define("databaseEditor/components/itemListFilter/itemListFilter.rt",["react","lodash","baseUI","symbols","constants"],function(e,t,i,s,a){"use strict";return function(){return e.createElement("span",{className:t({"item-list-filter":!0,"is-open":this.state.isBubbleOpen}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement("span",{},this.translateIfNeeded("list_dbe_items_filter_label")," "),e.createElement("span",{className:"item-list-filter-value-label",ref:"handler",onClick:this.toggleBubble},"\n        ",this.getValueLabel(),"\n        ",e.createElement(s.symbol,{name:"arrowDown"})),this.state.isBubbleOpen?e.createElement(i.bubble,{key:"itemFilterBubble",value:this.getBubbleContent(),closeTriggers:[a.UI.TOOLTIP.TRIGGERS.CLICK,a.UI.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:a.UI.TOOLTIP.ALIGNMENT.BOTTOM,styleType:a.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.closeBubble,targetNode:this.refs.handler}):null)}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble.rt",["react","lodash","symbols"],function(e,t,i){"use strict";return function(){return e.createElement.apply(this,["div",{className:"item-list-filter-bubble"},t.map(this.props.options,function(s,a){return e.createElement("div",{key:s.value,onClick:function(e,t){this.props.onChange(e.value)}.bind(this,s,a),className:t({"item-list-filter-bubble-option":!0,selected:this.props.value===s.value}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement(i.symbol,{name:"check"}),e.createElement("span",{},this.translateIfNeeded(s.label)))}.bind(this))])}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble",["create-react-class","prop-types","lodash","util","databaseEditor/components/itemListFilter/itemListFilterBubble.rt"],function(e,t,i,s,a){"use strict";return e({displayName:"itemListFilterBubble",mixins:[s.translationMixin],propTypes:{value:t.any.isRequired,onChange:t.func.isRequired,options:t.arrayOf(t.shape({label:t.string.isRequired,value:t.any.isRequired})).isRequired},render:a})}),define("databaseEditor/components/itemListFilter/itemListFilter",["react","create-react-class","prop-types","lodash","util","databaseEditor/components/itemListFilter/itemListFilter.rt","databaseEditor/components/itemListFilter/itemListFilterBubble"],function(e,t,i,s,a,n,r){"use strict";var l={all:"list_dbe_items_filter_all",visible:"list_dbe_items_filter_visible",hidden:"list_dbe_items_filter_hidden"};return t({displayName:"itemListFilter",mixins:[a.translationMixin],propTypes:{value:i.oneOf(["all","visible","hidden"]).isRequired,onChange:i.func.isRequired},getInitialState:function(){return{isBubbleOpen:!1}},getValueLabel:function(){return this.translateIfNeeded(l[this.props.value])},toggleBubble:function(){this.setState({isBubbleOpen:!this.state.isBubbleOpen})},closeBubble:function(){this.setState({isBubbleOpen:!1})},getBubbleContent:function(){return e.createElement(r,{value:this.props.value,onChange:function(e){this.props.onChange(e),this.closeBubble()}.bind(this),options:s.map(l,function(e,t){return{label:e,value:t}})})},render:n})}),define("databaseEditor/components/itemsList.rt",["react","lodash","baseUI","baseUILib","uiAnimations","databaseEditor/components/itemListRow","databaseEditor/components/noItems","databaseEditor/components/itemListFilter/itemListFilter"],function(e,t,i,s,a,n,r,l){"use strict";return function(){function o(){var o=i.sortByDragList,d=this.getSelectedIds().length;return e.createElement("div",function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"items-list "+(this.props.openedItemId?"small":"")},this.filteredProps()),e.createElement("header",{className:"list-header"},e.createElement("span",{className:"list-header-left-pane"},e.createElement("span",{className:"list-title"},this.props.listName),this.props.openedItemId?null:e.createElement(l,{key:"itemListFilter",value:this.state.itemsFilter,onChange:this.setItemsFilter})),e.createElement(i.button,{className:"add-item-btn",label:"list_dbe_edit_item_add_item",onClick:this.addItem})),e.createElement("div",{className:this.props.openedItemId?"add-item-container":"select-all-container"},e.createElement("span",{className:"select-all-checkbox"},e.createElement(s.Checkbox,{labelAfterSymbol:!0,value:d>0,indeterminate:d>0&&d<this.filteredItems().length,label:this.getItemsSelectionLabel(d),shouldTranslate:!1,onChange:function(e,t){this.toggleAllItems()}.bind(this,o,d)})),this.props.openedItemId?e.createElement(i.button,{key:"list-view-add-btn",label:"list_dbe_edit_item_add_item",className:"small-add-item",onClick:this.addItem}):null,this.getSelectedIds().length>0?e.createElement("span",{key:"multi-select-actions",className:"multi-select-action-menu checked"},e.createElement(i.button,{className:"multi-duplicate",label:"list_dbe_duplicate_Items",icon:"duplicate",onClick:this.duplicateSelectedItems}),e.createElement(i.button,{className:"multi-delete",label:"list_dbe_delete_items",icon:"delete",onClick:this.deleteSelectedItems}),e.createElement(i.button,{className:"multi-show-hide",label:"list_dbe_show_hide_multiple_items",icon:"quickActionsShow",onClick:this.showHideSelectedItems})):null),0!==this.allItems().length||this.props.loading?null:e.createElement(r,{key:"no-items"}),e.createElement(s.CustomScroll,{heightRelativeToParent:"calc(100% - 120px)"},e.createElement("div",{className:this.props.openedItemId?"items-container-edit":"items-container"},this.shouldShowVisibleItems()?e.createElement.apply(this,[o,{ref:"sortList",key:"da-list",className:t({"sort-list":!this.props.openedItemId,"item-edit-sort-list":this.props.openedItemId,"visible-items-container":!0}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),onItemMoved:this.getDbEditorApi().moveItem,childrenTransition:a.contentAddRemove},t.map(this.props.items,function(i,s,a,r){return e.createElement(n,{key:a._iid,item:a,className:t({"hidden-item":!1,selected:this.isSelected(a._iid),"no-hover":s>0,"is-open":this.props.openedItemId===a._iid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),isHidden:!1,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(a._iid),visibleFields:this.props.visibleFields,onSelect:function(e,t,i,s){this.toggleItem(i._iid)}.bind(this,i,s,a,r),onStartDrag:function(e,t,i,s,a){!this.props.openedItemId&&this.refs.sortList.startDrag(s,a)}.bind(this,i,s,a,r)})}.bind(this,o,d))]):null,this.shouldShowHiddenItems()?e.createElement.apply(this,["span",{className:"hidden-items-container",key:"hidden-items-container"},t.map(this.props.hiddenItems,function(i,s,a,r){return e.createElement(n,{key:a._iid,item:a,className:t({"hidden-item":!0,selected:this.isSelected(a._iid),"no-hover":s>0,"is-open":this.props.openedItemId===a._iid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),isHidden:!0,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(a._iid),visibleFields:this.props.visibleFields,onSelect:function(e,t,i,s){this.toggleItem(i._iid)}.bind(this,i,s,a,r)})}.bind(this,o,d))]):null)))}return o.apply(this,[])}}),define("databaseEditor/components/itemsList",["create-react-class","prop-types","lodash","util","databaseEditor/components/itemsList.rt","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i,s,a,n){"use strict";function r(e){var t=this.getSelectedIds();return i.filter(e,function(e){return i.includes(t,e._iid)})}return e({displayName:"itemsList",mixins:[n,s.selectionMixin,s.propTypesFilterMixin],propTypes:{items:t.array.isRequired,hiddenItems:t.array.isRequired,openedItemId:t.string,listName:t.string.isRequired,listId:t.string.isRequired,visibleFields:t.arrayOf(t.string)},getDefaultProps:function(){return{openedItemId:void 0}},getInitialState:function(){return{itemsFilter:"all"}},duplicateSelectedItems:function(){this.getDbEditorApi().duplicateItems(r.call(this,this.filteredItems()),"multiple_selection"),this.clearSelection()},deleteSelectedItems:function(){this.getDbEditorApi().deleteItems(r.call(this,this.filteredItems()),"multiple_selection",this.clearSelection)},showHideSelectedItems:function(){var e=r.call(this,this.props.items),t=r.call(this,this.props.hiddenItems),i=t.length>0?"showItems":"hideItems";this.getDbEditorApi()[i](e.concat(t),"multiple_selection")},addItem:function(){var e=this.props.openedItemId?"item_view":"list_view";this.getDbEditorApi().addItem(e,function(e){this.getDbEditorApi().setCurrentItem(e)}.bind(this)),this.clearSelection(),i.includes(["all","visible"],this.state.itemsFilter)||this.setState({itemsFilter:"all"})},setCurrentItem:function(e){var t=this.getDbEditorApi(),i=this.props.openedItemId?"item_view":"list_view";t.setCurrentItem(e,i)},toggleItem:function(e){var t=this.isSelected(e);this.toggle(e),this.getDbEditorApi().bi.itemSelectionToggle(this.props.listId,e,!t)},toggleAllItems:function(){var e=i.map(this.filteredItems(),"_iid"),t=!i.isEmpty(this.getSelectedIds());this.toggleAll(e),this.getDbEditorApi().bi.allItemsSelectionToggle(this.props.listId,!t)},getItemsSelectionLabel:function(e){switch(e){case 0:return s.translate("list_dbe_select_all_label");case 1:return s.translate("list_dbe_1_items_selected");default:return s.translate("list_dbe_x_items_selected").replace("<X>",e)}},allItems:function(){return this.props.items.concat(this.props.hiddenItems)},setItemsFilter:function(e){this.setState({itemsFilter:e}),this.clearSelection()},filteredItems:function(){switch(this.state.itemsFilter){case"all":return this.allItems();case"visible":return this.props.items;case"hidden":return this.props.hiddenItems;default:return this.props.items}},shouldShowVisibleItems:function(){return this.props.items.length&&i.includes(["all","visible"],this.state.itemsFilter)},shouldShowHiddenItems:function(){return this.props.hiddenItems.length&&i.includes(["all","hidden"],this.state.itemsFilter)},render:a})}),define("databaseEditor/components/itemEdit.rt",["react","lodash","baseUI","baseUILib"],function(e,t,i,s){"use strict";return function(){function a(){var a=this.props.item;return e.createElement("div",function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"item-edit",key:this.props.item._iid},this.filteredProps()),e.createElement("div",{className:"no-scroll-container"},e.createElement("header",{className:"item-header"},e.createElement("div",{className:"button-container"},e.createElement(i.button,{className:"close-item-btn",icon:"arrowRight",label:"list_dbe_edit_item_close_item",onClick:function(e){this.getDbEditorApi().setCurrentItem(null)}.bind(this,a)})),e.createElement("span",{className:"action-container"},this.state.saveLabel?e.createElement("div",{className:"save-item-label",key:"save-item-label"},this.translateIfNeeded(this.state.saveLabel)):null,e.createElement(i.tooltip,{value:"list_dbe_hover_item_delete_tooltip"},e.createElement(i.button,{className:"delete-item-btn",icon:"delete",onClick:function(e){this.getDbEditorApi().deleteItems([e],"edit_item")}.bind(this,a)})),e.createElement(i.tooltip,{value:"list_dbe_hover_item_duplicate_tooltip"},e.createElement(i.button,{className:"duplicate-item-btn",icon:"duplicate",onClick:function(e){this.getDbEditorApi().duplicateItems([e],"edit_item")}.bind(this,a)}))))),e.createElement(s.CustomScroll,{heightRelativeToParent:"calc(100% - 67px)"},e.createElement.apply(this,["div",{className:"item-fields-container"},t.map(this.getFields(),function(t,i,s){return e.createElement("div",{className:"item-field",key:i.definition.name},e.createElement(i.component,{ref:s,item:t,fieldDef:i.definition,placeholder:i.placeholder,visibleSections:{PhoneLink:!1}}))}.bind(this,a)),e.createElement("div",{className:"unused-fields-text"},this.translateIfNeeded("list_dbe_edit_hiding_unused_fields"))])))}return a.apply(this,[])}}),define("databaseEditor/components/linkTo/linkToField.rt",["react","lodash","panels","util"],function(e,t,i,s){"use strict";return function(){return e.createElement(i.commonControls.linkTo,function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:s.inheritClassName("input-link-to-field"),value:this.getLinkData(),onChange:this.setLinkData,showButton:!1,showIcon:!0},this.filterProps()))}}),define("databaseEditor/components/linkTo/linkToFieldButton.rt",["react","lodash","panels"],function(e,t,i){"use strict";return function(){return e.createElement(i.commonControls.linkToButton,t.assign({},{value:this.getLinkData(),onChange:this.setLinkData},this.filterProps()))}}),define("databaseEditor/components/linkTo/linkToField",["create-react-class","prop-types","lodash","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/linkTo/linkToField.rt","databaseEditor/components/linkTo/linkToFieldButton.rt"],function(e,t,i,s,a,n){"use strict";return e({displayName:"linkToField",propTypes:{item:t.object.isRequired,fieldDef:t.object.isRequired,useLinkButton:t.bool,label:t.string,placeholder:t.string,minCharsForTooltip:t.number,showButton:t.bool,buttonEditLabel:t.string,buttonAddLabel:t.string},mixins:[s],getDefaultProps:function(){return{useLinkButton:!1}},getLinkData:function(){return this.props.item.links&&this.props.item.links[this.props.fieldDef.name]},setLinkData:function(e){var t={};t[this.props.fieldDef.name]=e,this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,{links:t})},filterProps:function(){return i.omit(this.props,["pages","anchors","value","onChange","valueLink"])},render:function(){return(this.props.useLinkButton?n:a).call(this)}})}),define("databaseEditor/components/itemFields/textItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:"text-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"text-input"},e.createElement(i.textInput,{value:t.unescape(this.getFieldValue()),onChange:function(e){this.updateFieldValue(t.escape(e))}.bind(this),maxLength:500,placeholder:this.props.placeholder}),this.hasLink()?null:e.createElement(s,t.assign({},{key:"noLink",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?e.createElement(s,function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"input-link-to",key:"hasLink",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps())):null)}}),define("databaseEditor/mixins/itemFieldMixin",["lodash","prop-types","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i){"use strict";return{propTypes:{item:t.object.isRequired,fieldDef:t.object.isRequired},mixins:[i],getFieldDisplayName:function(){return this.props.fieldDef.displayName||this.props.fieldDef.name},getFieldValue:function(e,t){var i=t||this.props,s=i.item[i.fieldDef.name];return e&&(s=function(e,t){return(t||[]).reduce(function(e,t){return e&&e[t]},e)}(s,e)),s},updateFieldValue:function(e,t){var i=function(e){return e.reduceRight(function(e,t){var i={};return i[t]=e,i})}([this.props.fieldDef.name].concat(t||[]).concat(e));this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,i)},linkedFieldValue:function(e){var t=this;return{value:this.getFieldValue(e),requestChange:function(i){t.updateFieldValue(i,e)}}},hasLink:function(){return this.props.item.links&&!!this.props.item.links[this.props.fieldDef.name]},getLinkToFieldProps:function(){return e.pick(this.props,["item","fieldDef","visibleSections"])}}}),define("databaseEditor/components/itemFields/textItemField",["create-react-class","lodash","databaseEditor/components/itemFields/textItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){"use strict";return e({displayName:"textItemField",mixins:[s],render:i})}),define("databaseEditor/components/itemFields/buttonItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:"text-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"text-input"},e.createElement(i.textInput,{valueLink:this.linkedFieldValue(),placeholder:"list_dbe_button_placeholder",maxLength:100})),e.createElement(s,t.assign({},{label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps()),'\r\n            showIcon="',!0,'"\r\n    '))}}),define("databaseEditor/components/itemFields/buttonItemField",["create-react-class","lodash","databaseEditor/components/itemFields/buttonItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){"use strict";return e({displayName:"buttonItemField",mixins:[s],render:i})}),define("databaseEditor/components/itemFields/dateItemField.rt",["react","lodash","baseUI","constants","symbols","util","uiAnimations","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s,a,n,r,l){"use strict";return function(){function o(){var o=this.getValueAsDate();return e.createElement("div",{className:"date-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"text-input"},e.createElement("div",{className:t({"control-text-input":!0,"date-picker-open":this.state.dateBubbleOpen}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),onClick:this.toggleDateBubble},e.createElement(a.symbol,{name:"calendar"}),e.createElement("span",{ref:"dateSpan",className:t({disabled:t.isEmpty(this.getFieldValue().iso)}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},o?o.toLocaleDateString():n.translate("list_dbe_date_empty"))),this.hasLink()?null:e.createElement(l,t.assign({},{key:"add-link-button",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?e.createElement(l,function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"input-link-to",key:"link-to-field",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps())):null,e.createElement(r.tooltipAnimation,{},this.state.dateBubbleOpen?e.createElement(i.bubble,{key:"dateBubble",value:this.getDatePicker(o),width:"301px",closeTriggers:[s.UI.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:s.UI.TOOLTIP.ALIGNMENT.BOTTOM,styleType:s.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.hideDateBubble,targetNode:this.refs.dateSpan,ref:"popup",style:{position:"absolute"}}):null))}return o.apply(this,[])}}),define("databaseEditor/components/itemFields/dateItemField",["react","create-react-class","lodash","baseUI","databaseEditor/mixins/itemFieldMixin","databaseEditor/components/itemFields/dateItemField.rt"],function(e,t,i,s,a,n){"use strict";var r=["January","February","March","April","May","June","July","August","September","October","November","December"],l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return t({displayName:"dateItemField",mixins:[a],getInitialState:function(){return{dateBubbleOpen:!1}},getDatePicker:function(t){var a={value:t,onChange:this.updateDate,todayLabel:"list_DatePicker_TodayButton_Label",goToSelectedLabel:"list_DatePicker_GoToSelectedButton_Label",monthNames:i.map(r,function(e){return"list_DatePicker_MonthsConstLong_"+e}),days:i.map(l,function(e){return"list_DatePicker_DayConstShort_"+e}),startDay:"list_DatePicker_DayConstShort_Sunday",popOnlyValue:!0,showDelete:!0};return e.createElement(s.datePicker,a)},getValueAsDate:function(){var e=this.getFieldValue();return e&&e.iso?new Date(e.iso):null},updateDate:function(e){this.updateFieldValue(e?e.toISOString():"","iso"),this.toggleDateBubble()},toggleDateBubble:function(){this.setState({dateBubbleOpen:!this.state.dateBubbleOpen})},hideDateBubble:function(){this.setState({dateBubbleOpen:!1})},render:n})}),define("databaseEditor/components/itemFields/imageItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s){"use strict";return function(){function a(){var a=this.getFieldValue();return e.createElement("div",{},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"image-item-field"},e.createElement(i.imageChangeRemove,{className:"image-panel",addButtonLabel:"list_dbe_edit_item_image_add_image",changeButtonLabel:"list_dbe_edit_item_change_image",removeButtonLabel:"list_dbe_edit_item_remove_image",onChange:this.onMediaRemoved,mediaManager:this.getDbEditorApi().mediaServices.mediaManager,focusEditorFunc:this.getDbEditorApi().mediaServices.setFocusToEditor,value:this.getWPhotoData(a)}),e.createElement("div",{className:"text-panel"},e.createElement(i.textInput,{label:"list_dbe_edit_item_alt",placeholder:"list_dbe_edit_item_alt_placeholder",value:a.title,onChange:this.updateTitle,maxLength:100,disabled:t.isEmpty(a.src)}),e.createElement(s,function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"input-link-to",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder",disabled:t.isEmpty(a.src),showIcon:!0},this.getLinkToFieldProps())))))}return a.apply(this,[])}}),define("databaseEditor/components/itemFields/imageItemField",["create-react-class","lodash","databaseEditor/components/itemFields/imageItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){"use strict";return e({displayName:"imageItemField",mixins:[s],updateTitle:function(e){this.updateFieldValue(e,["title"])},getWPhotoData:function(e){return t.assign({type:"Image",uri:e.src},t.pick(e,["title","width","height"]))},onMediaRemoved:function(e){var i={src:"",title:"",height:0,width:0};e&&t.assign(i,{src:e.uri,title:e.title,height:e.height,width:e.width}),this.updateFieldValue(i)},render:i})}),define("databaseEditor/components/itemFields/richTextItemField.rt",["react","lodash","textControls","wixRichText"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:t({"rich-text-item-field":!0,editing:this.state.editing}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:t({"rich-text-input-control":!0,"rich-text-input":!0,"with-toolbar":this.state.editing}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement(i.richTextFrame,{onOuterClick:this.onOuterClick},this.state.editing?e.createElement(i.textToolBar,t.assign({},{key:"textToolbar",ref:"toolbar",textManager:this.manager,linksHelper:this.linksHelper,cmdState:this.state.cmdState,openLinkPanel:this.openLinkDialog,openColorPicker:this.openColorPicker},this.getToolbarProps())):null,e.createElement(s.TextEditor,{initialData:this.getInitialValue(),onReady:this.setReady,showToolbar:!1,validateHtml:!1,documentServicesApi:this.getDbEditorApi().siteInfo,stylesManager:this.getStyleManager(),linksManager:this.getLinksManager(),onDataChange:this.handleDataChanged,autoGrow:!1,onCut:this.onCutOrCopy,onCopy:this.onCutOrCopy}))))}}),define("databaseEditor/migrations/richTextMigrations",["lodash"],function(e){"use strict";function t(t){return e.get(t,"version",0)>=i?t:(t.text=function(e){return e=e.replace(s,""),e=e.replace(a,"")}(t.text),t.version=i,t)}var i=3,s=/<hatul[^>]*>/gi,a=/<\/hatul>/gi;return{migrateToCurrentVersion:t,getCurrentVersion:function(){return i}}}),define("databaseEditor/components/itemFields/richTextItemField",["create-react-class","lodash","stateManagement","util","databaseEditor/components/itemFields/richTextItemField.rt","databaseEditor/mixins/itemFieldMixin","textControls","databaseEditor/migrations/richTextMigrations"],function(e,t,i,s,a,n,r,l){"use strict";return e({displayName:"richTextItemField",mixins:[n],getInitialState:function(){return{editing:!1}},getToolbarProps:function(){var e=this.getDbEditorApi().getSiteInfo();return{themeColors:e.theme.colors.getAll(),themeFonts:e.theme.fonts.getAll(),fonts:r.fontUtils.getCurrentSelectableFontsWithParams(e),themeMap:e.theme.fonts.getMap(),isColorPickerClosed:this.isColorPickerClosed(),isLinkDialogClosed:this.isLinkDialogClosed(),isDeveloperMode:e.developerMode.isEnabled()}},isColorPickerClosed:function(){var e=this.getDbEditorApi();return i.editorPlugins.panels.selectors.isColorPickerClosed(e.siteInfo.store.getState())},isLinkDialogClosed:function(){var e=this.getDbEditorApi();return i.editorPlugins.panels.selectors.isLinkDialogClosed(e.siteInfo.store.getState())},getValue:function(){var e=this.getFieldValue();return"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(e=l.migrateToCurrentVersion(e)),{text:e.text,linkList:e.links}},getInitialValue:function(){return r.dataUtils.wrapOrphans(this.getValue().text)},handleDataChanged:function(e){this.updateValue({text:e,linkList:this.linksHelper.getAllLinks()})},updateValue:function(e){var t={text:e.text,links:e.linkList};"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(t.version=l.getCurrentVersion()),this.updateFieldValue(t)},getPanelManager:function(){return this.getDbEditorApi().panelManager},openLinkDialog:function(e,t){var i=this.getDbEditorApi(),a=s.link.getLinkPanelProps(i.documentServices,{link:e,callback:t,visibleSections:this.props.visibleSections});i.panelManager.openPanel("panels.toolPanels.linkPanel",a)},setReady:function(e){this.manager=e;var t=this;this.manager.onCmdStateChange(function(e){t.setState({cmdState:e})});var i=this.getDbEditorApi().siteInfo.theme.fonts.getAll(),s=r.fontUtils.getUploadedUsedFonts(this.getValue().text,i);r.ckUtils.insertUploadedFontsToCk(s,this.manager),this.manager.onFocus(function(){t.onFocus()}),this.linksHelper.setCurrentLinks(this.getValue().linkList);var a=this.manager.getCommandsStates();this.setState({cmdState:a})},openColorPicker:function(e,t,i,s,a){this.getDbEditorApi().panelManager.openPanel("panels.toolPanels.colorPicker.colorPickerPanel",{value:t,onChange:e,isBlockingLayerFullScreen:!0,shouldBlockOuterScroll:!0,top:s.top,left:s.left,previewOnHover:a},!0)},onFocus:function(){r.ckUtils.removeOverflowCss(this.manager),this.setState({editing:!0})},isFocusOnToolbar:function(){if(this.refs.toolbar)return!this.isColorPickerClosed()||!this.isLinkDialogClosed()||this.refs.toolbar.isAnyDropdownOpen()},onOuterClick:function(){this.isFocusOnToolbar()||(r.ckUtils.setOverflowCss(this.manager),this.setState({editing:!1}),this.clearUnusedLinks(),this.manager.unRegisterListener(this.handleCommandState))},getNonPasteableLinkTypes:function(){return t.pick(s.link.LinkTypes,["PHONE_LINK"])},componentWillMount:function(){this.linksHelper=new r.LinksHelper([],this.getNonPasteableLinkTypes()),this.linksManager=new r.TextLinksManager(this.linksHelper),this.stylesManager={getFonts:t.partial(r.fontUtils.getCurrentSelectableFontsWithParams,this.getDbEditorApi().siteInfo,!1,!0)}},getStyleManager:function(){return this.stylesManager},getLinksManager:function(){return this.linksManager},onCutOrCopy:function(){this.linksHelper.cacheCopiedLinks()},clearUnusedLinks:function(){var e=this.linksHelper.getAllLinks(),i=this.manager.getLinkRefsList(),s=t.filter(e,function(e){return t.includes(i,e.id)});if(!t.isEqual(s,this.getValue().linkList)){this.updateValue({text:this.getValue().text,linkList:s})}},render:a})}),define("databaseEditor/components/itemFields/videoItemField.rt",["react","lodash","baseUI","util"],function(e,t,i,s){"use strict";return function(){return e.createElement("div",{className:"video-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),function(){var t=this.state.status;return e.createElement("div",{className:"inputs-container "+t},e.createElement(i.videoInput,{valueLink:this.linkedFieldValue(),nonEmptyButtonLabel:"list_dbe_edit_item_search_video",emptyButtonLabel:"list_dbe_edit_item_search_video",panelManager:this.getDbEditorApi().panelManager}),e.createElement("div",{},e.createElement(i.textInput,{ref:"textInput",className:"video-url-input",label:"list_dbe_edit_item_video_url",value:this.state.videoUrl,onChange:this.updateVideoUrl,placeholder:this.props.placeholder}),e.createElement("div",{className:"error-msg-and-button"},e.createElement("span",{},"invalid"===t?s.translate("list_dbe_edit_item_bad_video_url"):""),this.state.videoUrl!==this.getVideoUrl()&&"idle"===t?e.createElement(i.button,{key:"update-button",className:"update-button",label:"list_dbe_edit_item_update_video_url",onClick:this.handleClick}):null,"idle"!==t?e.createElement(i.symbol,{key:"validation-status",name:"valid"===t?"inputValidationSuccess":"inputValidationError"}):null)))}.apply(this,[]))}}),define("databaseEditor/components/itemFields/videoItemField",["create-react-class","lodash","util","databaseEditor/components/itemFields/videoItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s,a){"use strict";function n(){this.success=!0;if(this.setState({status:"valid"}),t.isEmpty(this.state.videoUrl))this.updateFieldValue({videoId:""});else{var e=i.videoUtils.getVideoDataFromUrl(this.state.videoUrl);this.updateFieldValue({videoType:e.videoType,videoId:e.videoId})}t.delay(function(){this.success=!1,this.setState({status:"idle"})}.bind(this),2e3)}return e({displayName:"videoItemField",mixins:[a],getInitialState:function(){return{status:"idle",videoUrl:this.getVideoUrl()}},componentWillReceiveProps:function(e){var i=this.getVideoUrl(e);t.isEqual(this.getVideoUrl(),i)||this.updateVideoUrl(i)},getVideoUrl:function(e){return i.videoUtils.getVideoUrl(this.getFieldValue(null,e))},updateVideoUrl:function(e){this.setState({status:this.success?this.state.status:"idle",videoUrl:e})},handleClick:function(){t.isEmpty(this.state.videoUrl)?t.defer(n.bind(this)):i.videoUtils.verifyVideoUrl(this.state.videoUrl,n.bind(this),function(){this.setState({status:"invalid"}),this.refs.textInput.focus()}.bind(this))},render:s})}),define("databaseEditor/components/itemEdit",["create-react-class","prop-types","lodash","util","databaseEditor/components/itemEdit.rt","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemFields/textItemField","databaseEditor/components/itemFields/buttonItemField","databaseEditor/components/itemFields/dateItemField","databaseEditor/components/itemFields/imageItemField","databaseEditor/components/itemFields/richTextItemField","databaseEditor/components/itemFields/videoItemField"],function(e,t,i,s,a,n,r,l,o,d,c,m){"use strict";function u(e){if(e.item._iid!==this.props.item._iid)this.setState({saveLabel:null});else{var t=e.saveState!==this.props.saveState;(t=t&&!("Idle"===e.saveState&&i.includes(["Saved","Failed","Error"],this.props.saveState)))&&this.setState({saveLabel:function(e){return h[e]}(e.saveState)})}}var p={string:r,"string|asprice":r,"string|asbutton":l,"wix:image":d,"wix:richtext":c,"wix:video":m,"wix:date":o},h={Error:"list_dbe_edit_item_status_error",Saving:"list_dbe_edit_item_status_saving",Saved:"list_dbe_edit_item_status_saved",Idle:"list_dbe_edit_item_status_idle",Failed:"list_dbe_edit_item_status_error"},b={Title:"list_dbe_title_placeholder",Subtitle:"list_dbe_subtitle_placeholder",Description:"list_dbe_description_placeholder",Price:"list_dbe_price_placeholder",Video:"list_dbe_edit_item_video_link_placeholder"};return e({displayName:"itemEdit",mixins:[n,s.propTypesFilterMixin,s.blockOuterScrollMixin,s.translationMixin],propTypes:{item:t.object.isRequired,itemSchema:t.object.isRequired,saveState:t.string.isRequired,visibleFields:t.arrayOf(t.string)},getInitialState:function(){return{saveLabel:null}},componentWillReceiveProps:function(e){u.call(this,e)},getFields:function(){var e=this;return i(e.props.itemSchema.fields).filter(function(t){return i.includes(e.props.visibleFields,t.name)||"title"===t.name}).map(function(e){return{component:function(e){var t=e.metadata&&e.metadata.showAsHint,s=i.compact([e.type,t]).join("|");return p[s.toLowerCase()]}(e),definition:e,placeholder:b[e.displayName]||""}}).filter("component").value()},render:a})}),define("databaseEditor/dbEditor/dbEditor.rt",["react","lodash","databaseEditor/components/itemsList","databaseEditor/components/itemEdit","uiAnimations"],function(e,t,i,s,a){"use strict";return function(){return e.createElement("div",{className:"db-editor-container",onMouseDown:this.blockMiddleMouseClick},e.createElement(i,{items:this.props.items,hiddenItems:this.props.hiddenItems,openedItemId:this.props.currentItemId,listName:this.props.listName,listId:this.props.currentListId,visibleFields:this.props.visibleFields}),e.createElement(a.dbEditItemSlide,{direction:"right"},this.props.currentItemId?e.createElement(s,{key:"item-edit",item:this.getItem(this.props.currentItemId),itemSchema:this.props.itemSchema,visibleFields:this.props.visibleFields,saveState:this.props.saveState}):null))}}),define("databaseEditor/dbEditor/dbEditor",["create-react-class","prop-types","lodash","uiAnimations","databaseEditor/dbEditor/dbEditor.rt"],function(e,t,i,s,a){"use strict";return e({displayName:"dbEditor",mixins:[s.animationManager],propTypes:{dbEditorApi:t.object.isRequired,currentListId:t.string,items:t.array,hiddenItems:t.array,currentItemId:t.string,listName:t.string,itemSchema:t.object,saveState:t.string,visibleFields:t.arrayOf(t.string)},childContextTypes:{dbEditorApi:t.object.isRequired,mediaServices:t.object},getDefaultProps:function(){return{items:[]}},componentDidMount:function(){this.props.dbEditorApi.bi.dbEditorOpenSuccess(this.props.currentListId)},componentWillUnmount:function(){this.props.dbEditorApi.updateList()},getChildContext:function(){return{dbEditorApi:this.props.dbEditorApi,mediaServices:this.props.dbEditorApi.mediaServices}},getItem:function(e){return i.find(this.props.items,{_iid:e})||i.find(this.props.hiddenItems,{_iid:e})},blockMiddleMouseClick:function(e){if(1===e.button)return!1},render:a})}),define("databaseEditor/dbEditor/DbEditorApi",["lodash","mediaServices","util","experiment"],function(e,t,i,s){"use strict";function a(e){return"databaseEditor.panels."+e}function n(){var t=c.call(this);e.forEach(this.stateChangedCallbacks,function(e){e(t)})}function r(){return this.appbuilderServices.data.lists.getItems(this.currentListId)}function l(){return this.appbuilderServices.data.lists.getHiddenItems(this.currentListId)}function o(){var t=this.appbuilderServices.layout.getAllFields,i=e(this.currentListId).thru(t).reject("hidden").map("name").value(),s=e(t(this.currentListId,"Mobile")).reject("hidden").map("name").value();return e.uniq(i.concat(s))}function d(e,t){t?window.setTimeout(d.bind(this,e),t):(this.saveState=e,n.call(this))}function c(){var e=this.dataService.wasRepoLoaded(),t=e&&this.dataService.wasListLoaded(this.currentListId);return{currentListId:this.currentListId,items:t?r.call(this):[],hiddenItems:t?l.call(this):[],currentItemId:this.currentItemId,listName:e?function(){return this.appbuilderServices.data.lists.getListName(this.currentListId)}.call(this):null,itemSchema:e?this.appbuilderServices.data.lists.getItemSchema(this.currentListId):null,visibleFields:this.visibleFields,dbEditorApi:this,openPanels:this.panelManager.getOpenPanels(),saveState:this.saveState,loading:!t}}function m(){this.sohuldRender=!0,!0!==this.disableAutoSave?this.saveState!==b.saving?(d.call(this,b.saving),this.appbuilderServices.save(function(){if(d.call(this,b.saved),this.savePending)return this.savePending=!1,void m.call(this);window.setTimeout(function(){this.saveState!==b.saving&&d.call(this,b.idle)}.bind(this),this.idleTimeout)}.bind(this),function(){this.savePending=!1,d.call(this,b.failed),d.call(this,b.idle,this.idleTimeout),this.panelManager.openPanel(a("saveFailedMessagePanel"))}.bind(this))):this.savePending=!0:n.call(this)}function u(t,i){return e.filter(t,function(t){return e.find(i,{_iid:t._iid})})}function p(t,s){var a=e.assign({},s,{title:i.translate("list_dbe_prefix_for_duplicated_item")+s.title});return this.appbuilderServices.data.items.create(t,a)}function h(i,r,l,d,m,u,p,h,_,f,g){e.bindAll(this,["getServiceTopology","setCurrentList","getPagesData","getSiteMenuItems","createDefaultDataItem","setCurrentItem","debouncedSave","broadcastStateChanged","moveItem","addItem","updateItem","duplicateItems","deleteItems","showItems","hideItems","getCurrentListVersion","registerForStateChanged","getSiteInfo"]),this.disableAutoSave=f,this.idleTimeout=h,this.dataService=i,this.appbuilderServices=l.wixapps.appbuilder,this.documentServices=l,this.siteInfo=d,this.serviceTopology=m,this.stateChangedCallbacks=[],this.currentListId=p,this.currentItemId=null,this.saveState=b.idle,this.savePending=!1,this.sohuldRender=!1,this.panelManager=function(e){var t=Object.create(e);return t.openPanel=function(t,i){e.openPanel(t,i,!0)},t}(u),this.mediaServices=g||t.create(this),this.bi=r,s.isOpen("appBuilderDataMigration")&&this.appbuilderServices.migration.migrateList(p),i.registerForUpdates(function(e){var t=this.dataService.wasRepoLoadErroneous(),i=this.dataService.wasListLoadErroneous(e);t||i?(this.bi.listLoadFailed(e,!t,!i),this.panelManager.openPanel(a("loadFailedMessagePanel"),{onConfirm:function(){window.location.reload()}})):n.call(this)}.bind(this)),_&&(this.visibleFields=o.call(this),_(c.call(this)))}var b={idle:"Idle",saved:"Saved",failed:"Failed",saving:"Saving"};return h.prototype={updateList:function(){this.sohuldRender&&e.has(this.appbuilderServices.data,"markDataAsUpdated")&&(this.appbuilderServices.data.markDataAsUpdated(this.currentListId),this.sohuldRender=!1)},getServiceTopology:function(){return this.serviceTopology},setCurrentList:function(e){this.currentListId=e,this.currentItemId=null,this.dataService.loadListData(e),this.visibleFields=o.call(this),n.call(this)},getPagesData:function(){return this.documentServices.pages.getPagesData()},getSiteMenuItems:function(){return this.documentServices.mainMenu.getMenu()},createDefaultDataItem:function(e){return this.documentServices.data.createItem(e)},setCurrentItem:function(e,t){this.currentItemId=e,n.call(this),e&&t&&this.bi.itemEdit(t,this.currentListId,e)},debouncedSave:e.debounce(m,500),broadcastStateChanged:n,moveItem:function(e,t){var i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=i.itemIds,a=s[e];s.splice(t,0,s.splice(e,1)[0]),this.bi.itemMove(this.currentListId,i.id,a),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,s),m.call(this)},addItem:function(t,i){i=i||e.noop;var s=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),a=this.appbuilderServices.data.items.create(s),n=this.appbuilderServices.data.lists.selection.get(this.currentListId),r=n.itemIds;return r.unshift(a),this.bi.itemAdd(t,this.currentListId,n.id,a),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,r),i(a),m.call(this),a},updateItem:function(e,t,i){this.appbuilderServices.data.items.update(e,t,i),this.debouncedSave(),n.call(this)},duplicateItems:function(t,i){var s=e.map(t,"_iid"),a=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),n=this.appbuilderServices.data.lists.selection.get(this.currentListId);this.bi.itemsDuplicate(i,this.currentListId,n.id,s),e.forEach(u(t,l.call(this)),e.bind(p,this,a));var o=e.map(u(t,r.call(this)),e.bind(p,this,a)),d=n.itemIds,c=e.findLastIndex(d,function(t){return e.includes(s,t)});d.splice.apply(d,[c+1,0].concat(o)),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,d),this.currentItemId&&this.setCurrentItem(e.last(o)),m.call(this)},deleteItems:function(t,i,s){var n=this;s=s||e.noop,this.panelManager.openPanel(a("deleteItemsConfirmationPanel"),{onConfirm:function(){var a=n.appbuilderServices.data.lists.selection.get(n.currentListId);n.bi.itemsDelete(i,n.currentListId,a.id,e.map(t,"_iid")),e.forEach(t,function(t){if(n.currentItemId===t._iid){var i=e.map(r.call(n),"_iid"),s=i.indexOf(t._iid),a=i[s+1]||i[s-1]||null;n.setCurrentItem(a)}n.appbuilderServices.data.items.delete(t._type,t._iid)}),s(),m.call(n)},onCancel:e.noop})},showItems:function(t){var i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=e.map(t,"_iid"),a=e.union(i.itemIds,s);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,a),m.call(this)},hideItems:function(t){var i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=e.map(t,"_iid"),a=e.difference(i.itemIds,s);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,a),m.call(this)},getCurrentListVersion:function(){return this.appbuilderServices.data.lists.getListVersion(this.currentListId)},registerForStateChanged:function(e){this.stateChangedCallbacks.push(e)},getSiteInfo:function(){return this.siteInfo}},h}),define("databaseEditor/panels/deleteItemsConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){"use strict";return function(){return e.createElement(i.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"delete-list-items-confirmation",type:"important",panelTitle:this.translateIfNeeded("list_dbe_delete_are_you_sure_title"),onCancel:this.props.onCancel,onConfirm:this.props.onConfirm,confirmLabel:"list_dbe_delete_are_you_sure_confirm_button",cancelLabel:"list_dbe_delete_are_you_sure_cancel_button"},e.createElement(s.symbol,{name:"garbage-truck-clipart",className:"image"}),e.createElement("div",{className:"text"},e.createElement("span",{},this.translateIfNeeded("list_dbe_delete_items_subtitle")),e.createElement("span",{},this.translateIfNeeded("list_dbe_delete_are_you_sure_text"))))}}),define("databaseEditor/panels/deleteItemsConfirmationPanel",["create-react-class","util","lodash","databaseEditor/panels/deleteItemsConfirmationPanel.rt"],function(e,t,i,s){"use strict";return e({displayName:"deleteItems",mixins:[t.translationMixin],render:s})}),define("databaseEditor/panels/saveFailedMessagePanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){"use strict";return function(){return e.createElement(i.frames.messagePanelFrame,{className:"list-save-failed-panel",panelName:this.props.panelName,confirmLabel:"list_dbe_general_error_button",panelTitle:this.translateIfNeeded("list_dbe_general_error_dialog_title")},e.createElement("div",{className:"content-wrapper"},e.createElement(s.symbol,{name:"plaster",className:"error-img"}),e.createElement("div",{className:"msg-text"},e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_subtitle")),e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text")),e.createElement("p",{},e.createElement("br",{})),e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text_2")),e.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/"))))}}),define("databaseEditor/panels/saveFailedMessagePanel",["create-react-class","util","lodash","core","databaseEditor/panels/saveFailedMessagePanel.rt"],function(e,t,i,s,a){"use strict";return e({displayName:"saveFailedMessagePanel",mixins:[t.translationMixin,s.mixins.editorAPIMixin],render:a})}),define("databaseEditor/panels/loadFailedMessagePanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){"use strict";return function(){return e.createElement(i.frames.confirmationPanelFrame,{panelName:this.props.panelName,panelTitle:this.translateIfNeeded("list_dbe_loading_error_title"),className:"list-load-failed-panel",onConfirm:this.props.onConfirm,onCancel:this.props.onCancel,confirmLabel:"list_dbe_loading_error_button",cancelLabel:"list_dbe_error_loading_close_manage_items"},e.createElement(s.symbol,{name:"plaster",className:"error-img"}),e.createElement("div",{className:"msg-text"},e.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_subtitle")),e.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_text")),e.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/")))}}),define("databaseEditor/panels/loadFailedMessagePanel",["create-react-class","util","lodash","databaseEditor/panels/loadFailedMessagePanel.rt"],function(e,t,i,s){"use strict";return e({displayName:"loadFailedMessagePanel",mixins:[t.translationMixin],render:s})}),define("databaseEditor/panels/panels",["databaseEditor/panels/deleteItemsConfirmationPanel","databaseEditor/panels/saveFailedMessagePanel","databaseEditor/panels/loadFailedMessagePanel"],function(e,t,i){"use strict";return{deleteItemsConfirmationPanel:e,saveFailedMessagePanel:t,loadFailedMessagePanel:i}}),define("databaseEditor/bi/events",[],function(){"use strict";return{LIST_DB_MANAGER_OPENED:{src:59,endpoint:"listim2",evid:107,fields:{list_part_id:"string"}},LIST_DB_MANAGER_ERROR_LOADING:{src:59,endpoint:"listim2",evid:108,fields:{list_part_id:"string",error_description:"string"}},LIST_DB_MANAGER_REORDER_ITEMS_DROP:{src:59,endpoint:"listim2",evid:109,fields:{item_id:"string",list_part_id:"string",selector_id:"string"}},LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK:{src:59,endpoint:"listim2",evid:110,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_id:"string"}},LIST_DB_MANAGER_SELECT_ITEM_CLICK:{src:59,endpoint:"listim2",evid:113,fields:{list_part_id:"string",item_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_SELECT_ALL_CLICK:{src:59,endpoint:"listim2",evid:114,fields:{list_part_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_DUPLICATE_ITEM:{src:59,endpoint:"listim2",evid:117,fields:{origin:"string",list_part_id:"string",selector_id:"string",source_item_ids:"string"}},LIST_DB_MANAGER_DELETE_ITEMS_CLICK:{src:59,endpoint:"listim2",evid:118,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_ids:"string"}},LIST_DB_MANAGER_EDIT_ITEM_CLICK:{src:59,endpoint:"listim2",evid:119,fields:{origin:"string",list_part_id:"string",item_id:"string"}},LIST_DB_MANAGER_LIST_LOAD_FAIL:{src:59,endpoint:"listim2",evid:121,fields:{list_part_id:"string",repo_loaded:"bool",data_loaded:"bool"}}}}),define("databaseEditor/bi/service",["databaseEditor/bi/events","coreUtilsLib"],function(e,t){"use strict";function i(e){this._reportBI=e}return i.prototype={sendEvent:function(e,i){try{this._reportBI(e,i)}catch(e){t.log.info("Error sending BI event",e)}},dbEditorOpenSuccess:function(t){this.sendEvent(e.LIST_DB_MANAGER_OPENED,{list_part_id:t})},dbEditorOpenFailed:function(t,i){this.sendEvent(e.LIST_DB_MANAGER_ERROR_LOADING,{list_part_id:t,error_description:i.toString()})},listLoadFailed:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_LIST_LOAD_FAIL,{list_part_id:t,repo_loaded:i?"true":"false",data_loaded:s?"true":"false"})},itemMove:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_REORDER_ITEMS_DROP,{item_id:s,list_part_id:t,selector_id:i})},itemAdd:function(t,i,s,a){this.sendEvent(e.LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK,{origin:t,list_part_id:i,selector_id:s,item_id:a})},itemsDuplicate:function(t,i,s,a){this.sendEvent(e.LIST_DB_MANAGER_DUPLICATE_ITEM,{origin:t,list_part_id:i,selector_id:s,source_item_ids:a.join(",")})},itemsDelete:function(t,i,s,a){this.sendEvent(e.LIST_DB_MANAGER_DELETE_ITEMS_CLICK,{origin:t,list_part_id:i,selector_id:s,item_ids:a.join(",")})},itemEdit:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_EDIT_ITEM_CLICK,{origin:t,list_part_id:i,item_id:s})},itemSelectionToggle:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_SELECT_ITEM_CLICK,{list_part_id:t,item_id:i,state_after_click:!!s})},allItemsSelectionToggle:function(t,i){this.sendEvent(e.LIST_DB_MANAGER_SELECT_ALL_CLICK,{list_part_id:t,state_after_click:!!i})}},i}),define("databaseEditor",["databaseEditor/dbEditor/dbEditor","databaseEditor/dbEditor/DbEditorApi","databaseEditor/panels/panels","databaseEditor/bi/service"],function(e,t,i,s){"use strict";return{dbEditor:e,DbEditorApi:t,panels:i,BIService:s}});
//# sourceMappingURL=databaseEditor.min.js.map