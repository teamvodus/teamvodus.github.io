!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("lodash"));else if("function"==typeof define&&define.amd)define(["lodash"],t);else{var n="object"==typeof exports?t(require("lodash")):t(e._);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(window,function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=20)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.promiseApplied=function(e,t){return new Promise(function(n){e.waitForChangesApplied(function(){return n(t)})})}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hiddenComponents:{show:function(e,t,n,o){var r=o.componentRef;return new Promise(function(t){var n=e.pages.getFocusedPageId();e.mobile.hiddenComponents.show(r.id,n),e.waitForChangesApplied(t)})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o};function a(e){return{name:e.name,fullPath:e.location,isDirectory:e.directory}}t.default={listChildren:function(e,t,n,o){var r=e.wixCode.fileSystem,p=r.getVirtualDescriptor(o.path,!0);return r.getChildren(p).then(function(e){return i.default.map(e,a)})},readFile:function(e,t,n,o){var r=e.wixCode.fileSystem,i=r.getVirtualDescriptor(o.path,!1);return r.readFile(i)},writeFile:function(e,t,n,o){var r=e.wixCode.fileSystem,i=r.getVirtualDescriptor(o.path,!1);return r.writeFile(i,o.content)},flush:function(e){return e.wixCode.fileSystem.flush()},getViewerInfo:function(e){return e.wixCode.fileSystem.getViewerInfo()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o};t.default={isAppSectionInstalled:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=o.sectionId,a=o.appDefinitionId;return new Promise(function(n,o){if(r){var p=t.applicationId;if(a){var u=e.tpa.app.getDataByAppDefId(a);p=i.default.get(u,"applicationId")}return e.tpa.section.isSectionInstalledByTpaPageId(p,r)}o(new Error("options must contain sectionId"))})},isApplicationInstalled:function(e,t,n){var o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).appDefinitionId;return new Promise(function(t,n){o?t(e.tpa.app.isInstalled(o)):n(new Error("options must contain appDefinitionId"))})},add:{application:function(e,t,n,o){return new Promise(function(n,r){var a=i.default.clone(o);i.default.get(o,"appDefinitionId")?e.tpa.app.isInstalled(o.appDefinitionId)?r(new Error("Application already installed.")):e.tpa.appMarket.getDataAsync(o.appDefinitionId).then(function(p){p&&!p.error?"Wix"===p.by?(a.callback=function(a){if(a.onError)r(new Error(a.onError));else if(t=e.tpa.app.getDataByAppDefId(o.appDefinitionId),a.page){var p=e.pages.data.get(a.page.id);n({instanceId:i.default.get(t,"instanceId"),pageRef:a.page,pageUriSEO:i.default.get(p,"pageUriSEO"),title:i.default.get(p,"title")})}else n({instanceId:i.default.get(t,"instanceId")})},e.tpa.app.add(o.appDefinitionId,a)):r(new Error("Can't add a non Wix application")):r(new Error("Application with "+o.appDefinitionId+" appDefinitionId do not exist."))}):r(new Error("options must contain appDefinitionId"))})},component:function(e,t,n,o){return new Promise(function(n,r){var a=i.default.clone(o);if(i.default.get(o,"componentType")){if(o.appDefinitionId||(a.appDefinitionId=t.appDefinitionId),"WIDGET"===o.componentType){if(!i.default.isObject(o.widget))return void r(new Error("options must contain a widget object"));a.widget.tpaWidgetId=o.widget.widgetId}else if("PAGE"===o.componentType){if(!i.default.isObject(o.page))return void r(new Error("options must contain a page object"));if(o.page.isHidden&&!i.default.isBoolean(o.page.isHidden))return void r(new Error("isHidden param should be of type boolean"))}a.callback=function(t){if(t.onError)r(new Error(t.onError));else if("WIDGET"===o.componentType)n({compId:t.comp.id});else{var a=e.pages.data.get(t.page.id);n({compId:t.sectionId,pageRef:t.page,pageUriSEO:i.default.get(a,"pageUriSEO"),title:i.default.get(a,"title")})}},e.tpa.comp.add(a)}else r(new Error("options must contain componentType"))})}},app:{getDataByAppDefId:function(e,t,n,o){return e.tpa.app.getDataByAppDefId(o)},getAllCompsByApplicationId:function(e,t,n,o){return e.tpa.app.getAllCompsByApplicationId(o)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={colors:{getAll:function(e){return e.theme.colors.getAll()}},fonts:{getMap:function(e){return e.theme.fonts.getMap()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={getFooter:function(e){return e.siteSegments.getFooter()},getHeader:function(e){return e.siteSegments.getHeader()},getPagesContainer:function(e){return e.siteSegments.getPagesContainer()},getSiteStructure:function(e){return e.siteSegments.getSiteStructure()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o};function a(e,t,n,o){var r=o.routerRef,a=e.routers.get.byRef(r),p=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId");if(a&&p===a.appDefinitionId)return{id:a.id,prefix:a.prefix,config:a.config,pages:(0,i.default)(a.pages).invertBy().map(function(t,n){return{pageRef:e.pages.getReference(n),pageRoles:t}}).value()}}function p(e,t,n,o){var r=o.prefix,a=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),p=e.routers.getRouterRef.byPrefix(r);if(!p)return p;var u=e.routers.get.byRef(p);return u&&u.appDefinitionId===a?p:void 0}t.default={add:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=o.prefix,a=o.config,p=o.group;return new Promise(function(n,o){var u={appDefinitionId:i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),prefix:r,config:a};p&&(u.group=p);var f=e.routers.add(u);e.waitForChangesApplied(function(){e.routers.get.byRef(f)?n(f):o(new Error("Could not add router"))})})},remove:function(e,t,n,o){var r=o.routerRef;return new Promise(function(n){var o=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),a=e.routers.get.byRef(r);a&&a.appDefinitionId===o||n(),e.routers.remove(r),e.waitForChangesApplied(n)})},get:a,getAll:function(e,t,n){var o=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId");return i.default.map(e.routers.get.byApp(o),function(n){var o=n.prefix,r=p(e,t,0,{prefix:o});return a(e,t,0,{routerRef:r})})},update:function(e,t,n,o){var r=o.routerRef,a=o.prefix,p=o.config;return new Promise(function(n){var o=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),u=e.routers.get.byRef(r);u&&u.appDefinitionId===o||n(),e.routers.update(r,{prefix:a,config:p}),e.waitForChangesApplied(n)})},getByPage:function(e,t,n,o){var r=o.pageRef,a=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),p=e.routers.getRouterRef.byPage(r);if(!p)return p;var u=e.routers.get.byRef(p);return u&&u.appDefinitionId===a?p:void 0},getByPrefix:p,pages:{add:function(e,t,n,o){var r=o.routerRef,a=o.pageTitle,p=o.pageRoles;return new Promise(function(n){var o=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),u=e.routers.get.byRef(r);u&&u.appDefinitionId===o||n();var f=e.routers.pages.add(r,a,p);e.waitForChangesApplied(function(){return n(f)})})},delete:function(e,t,n,o){var r=o.routerRef,a=o.pageRef;return new Promise(function(n,o){var p=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),u=e.routers.get.byRef(r);u&&u.appDefinitionId===p?(e.pages.remove(a.id),e.waitForChangesApplied(n)):o()})},connect:function(e,t,n,o){var r=o.routerRef,a=o.pageRef,p=o.pageRoles;return new Promise(function(n){var o=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),u=e.routers.get.byRef(r);u&&u.appDefinitionId===o||n(),e.routers.pages.connect(r,a,p),e.waitForChangesApplied(n)})},disconnect:function(e,t,n,o){var r=o.routerRef,a=o.pageRef;return new Promise(function(n){var o=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),p=e.routers.get.byRef(r);p&&p.appDefinitionId===o||n(),e.routers.pages.disconnect(r,a),e.waitForChangesApplied(n)})},move:function(e,t,n,o){var r=o.fromRouterRef,a=o.toRouterRef,p=o.pageRef;return new Promise(function(n){var o=i.default.get(e.platform.getAppDataByApplicationId(t.applicationId),"appDefinitionId"),u=e.routers.get.byRef(r),f=e.routers.get.byRef(a);u&&f&&f.appDefinitionId===o&&u.appDefinitionId===o||n(),e.routers.pages.move(p,r,a),e.waitForChangesApplied(n)})},listConnectablePages:function(e){return e.routers.pages.listConnectablePages()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.default={create:function(e,t,n,r){var i=r.groupName,a=e.pagesGroup.create({groupName:i,appId:t.applicationId});return(0,o.promiseApplied)(e,a)},addPageToPagesGroup:function(e,t,n,r){var i=r.pagesGroupPointer,a=r.pageId;return e.pagesGroup.addPageToPagesGroup(i,a),(0,o.promiseApplied)(e)},getById:function(e,t,n,o){var r=o.pagesGroupId;return e.pagesGroup.getById(r)},getByGroupName:function(e,t,n,o){var r=o.groupName;return e.pagesGroup.getByGroupName(r)},getAll:function(e,t){return e.pagesGroup.getAll(t.applicationId)},remove:function(e,t,n,r){var i=r.pagesGroupPointer;return e.pagesGroup.remove(i),(0,o.promiseApplied)(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o},a=n(1);function p(e,t,n,o){var r=o.pageRef,p=o.pageLink,u=i.default.get(r,"id")||p;if(u)return e.pages.navigateTo(u),(0,a.promiseApplied)(e)}function u(e,t,n,o){var r=o.pageRef,a=e.pages.data.get(r.id);return i.default.pick(a,["title","hidePage","pageSecurity"])}t.default={navigateTo:p,getCurrent:function(e){return e.pages.getReference(e.pages.getFocusedPageId())},add:function(e,t,n,o){var r=o.title,i=o.definition;return p(e,0,0,{pageRef:e.pages.add(r,i)})},toggleHidePage:function(e,t,n,o){var r=o.pageRef,i=o.hidePage;return e.pages.data.update(r.id,{hidePage:i}),(0,a.promiseApplied)(e)},getPageData:u,data:{get:u,update:function(e,t,n,o){var r=o.pageRef,i=o.data;return e.pages.data.update(r.id,i),(0,a.promiseApplied)(e)}},permissions:{hasPassword:function(e,t,n,o){var r=o.pageRef;return e.pages.permissions.hasPassword(r.id)},updatePagePassword:function(e,t,n,o){var r=o.pageRef,i=o.plainPassword;return e.pages.permissions.updatePassword(r.id,i),(0,a.promiseApplied)(e)},removePagePassword:function(e,t,n,o){var r=o.pageRef;return e.pages.permissions.removePassword(r.id),(0,a.promiseApplied)(e)}},getApplicationPages:function(e,t){var n=e.platform.getAppDataByApplicationId(t.applicationId).appDefinitionId;return e.pages.getPagesData().filter(function(e){return e.managingAppDefId===n})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o},a=n(1);t.default={create:function(e,t,n,o){var r=o.menuData,p=o.customId,u=i.default.assign({appId:t.applicationId},r),f=e.menu.create(u,p);return(0,a.promiseApplied)(e,f)},connect:function(e,t,n,o){var r=o.menuCompPointer,i=o.menuId;return e.menu.connect(r,i),(0,a.promiseApplied)(e)},update:function(e,t,n,o){var r=o.menuId,i=o.menuData;return e.menu.update(r,i),(0,a.promiseApplied)(e)},remove:function(e,t,n,o){var r=o.menuId;return e.menu.remove(r),(0,a.promiseApplied)(e)},addItem:function(e,t,n,o){var r=o.menuId,i=o.menuItem;return e.menu.addItem(r,i),(0,a.promiseApplied)(e)},getById:function(e,t,n,o){var r=o.menuId;return e.menu.getById(r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.default={add:function(e,t,n,r){var i=r.languageCode;return e.language.add(i),(0,o.promiseApplied)(e)},current:{set:function(e,t,n,r){var i=r.languageCode;return e.language.current.set(i),(0,o.promiseApplied)(e)}},multilingual:{init:function(e,t,n,r){var i=r.languageCode;return e.language.multilingual.init(i),(0,o.promiseApplied)(e)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={getSiteId:function(e){return e.generalInfo.getSiteId()},getMetaSiteId:function(e){return e.generalInfo.getMetaSiteId()},isSitePublished:function(e){return e.generalInfo.isSitePublished()},getLanguage:function(e){return e.generalInfo.getLanguage()},isSiteSaved:function(e){return!e.generalInfo.isFirstSave()},getAppInstance:function(e,t){var n="wix-code"===t.appDefinitionId?e.wixCode.getClientSpec().applicationId:t.applicationId;return e.tpa.app.getData(n).instance},getUserId:function(e){return e.generalInfo.getUserId()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={add:function(e,t,n,o){var r=o.label;return new Promise(function(t){return e.waitForChangesApplied(function(){e.history.add(r),t()})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={getFontsOptions:function(e){return e.fonts.getFontsOptions()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o},a=n(1);var p="platform.components.AppController";function u(e,t,n){var o=e.platform.getAppDataByApplicationId(t).appDefinitionId,r=n?n.id:null;return e.components.getAllComponents(r,function(t){return e.components.getType(t)===p&&e.components.data.get(t).applicationId===o})}t.default={listControllers:function(e,t,n){var o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).pageRef,r=void 0===o?e.pages.getFocusedPage():o,a=u(e,t.applicationId,r);return i.default.map(a,function(e){return{controllerRef:e}})},listAllControllers:function(e,t){var n=u(e,t.applicationId);return i.default.map(n,function(e){return{controllerRef:e}})},listConnectableControllers:function(e,t,n,o){var r=o.componentRef,a=e.components.getPage(r),p=u(e,t.applicationId,a);return i.default.map(p,function(e){return{controllerRef:e}})},getControllerConnections:function(e,t,n,o){var r=o.controllerRef;return e.platform.controllers.connections.getControllerConnections(r)},listConnections:function(e,t,n,o){var r=o.componentRef,a=e.platform.controllers.connections.get(r);return i.default.reject(a,{type:"WixCodeConnectionItem"})},listConnectedComponents:function(e,t,n,o){var r=o.controllerRef;return e.platform.controllers.connections.getConnectedComponents(r)},connect:function(e,t,n,o){var r=o.connectToRef,i=o.controllerRef,p=o.role,u=o.connectionConfig,f=o.isPrimary;return e.platform.controllers.connections.connect(r,i,p,u,f),(0,a.promiseApplied)(e,{connectToRef:r,controllerRef:i,role:p})},disconnect:function(e,t,n,o){var r=o.connectToRef,i=o.controllerRef,p=o.role;return e.platform.controllers.connections.disconnect(r,i,p),(0,a.promiseApplied)(e)},getData:function(e,t,n,o){var r=o.controllerRef,a=e.platform.controllers.settings.get(r);return{type:i.default.get(e.components.data.get(r),"controllerType"),config:a,displayName:e.platform.controllers.getName(r)}},saveConfiguration:function(e,t,n,o){var r=o.controllerRef,i=o.config;return e.platform.controllers.settings.set(r,i),(0,a.promiseApplied)(e)},setDisplayName:function(e,t,n,o){var r=o.controllerRef,i=o.name;return e.platform.controllers.setName(r,i),(0,a.promiseApplied)(e)},setState:function(e,t,n,o){var r=o.state;return e.platform.controllers.setState(r),(0,a.promiseApplied)(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o},a=n(1);t.default={add:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=o.componentDefinition,a=o.pageRef;return new Promise(function(t,n){i.default.has(r,"componentType")||n(new Error("componentDefinition must contain componentType"));var o=e.components.buildDefaultComponentStructure(r.componentType);i.default.merge(o,r);var p=e.components.add(a,o);e.waitForChangesApplied(function(){e.components.is.exist(p)?t(p):n(new Error("Could not add component"))})})},remove:function(e,t,n,o){var r=o.componentRef;return e.viewMode.get()===e.viewMode.VIEW_MODES.MOBILE?e.mobile.hiddenComponents.hide(r):e.components.remove(r),(0,a.promiseApplied)(e)},get:function(e,t,n,o){var r=o.componentRefs,a=o.properties,p=void 0===a?[]:a,u=i.default.compact(i.default.isArray(r)?r:[r]);return i.default.transform(u,function(t,n){var o={componentRef:n},r=e.components.serialize(n);i.default.assign(o,i.default.pick(r,p)),i.default.includes(p,"sdkType")&&(o.sdkType=e.wixCode.getCompSdkType(n)),i.default.includes(p,"connections")&&(o.connections=e.platform.controllers.connections.get(n)),i.default.includes(p,"style")&&(o.style=e.components.style.get(n)),t.push(o)},[])},getAllComponents:function(e){return e.components.getAllComponents()},getPage:function(e,t,n,o){var r=o.componentRef;return e.components.getPage(r)},getById:function(e,t,n,o){var r=o.id;return e.components.get.byId(r)},getChildren:function(e,t,n,o){var r=o.componentRef,i=o.recursive,a=void 0!==i&&i;return e.components.getChildren(r,a)},getAncestors:function(e,t,n,o){var r=o.componentRef;return e.components.getAncestors(r)},getType:function(e,t,n,o){var r=o.componentRef;return e.components.getType(r)},properties:{get:function(e,t,n,o){var r=o.componentRef;return e.components.properties.get(r)},update:function(e,t,n,o){var r=o.componentRef,i=o.props;return e.components.properties.update(r,i),(0,a.promiseApplied)(e)}},data:{get:function(e,t,n,o){var r=o.componentRef;return e.components.data.get(r)},update:function(e,t,n,o){var r=o.componentRef,i=o.data;return e.components.data.update(r,i),(0,a.promiseApplied)(e)}},layout:{get:function(e,t,n,o){var r=o.componentRef;return e.components.layout.get(r)},update:function(e,t,n,o){var r=o.componentRef,i=o.layout;return e.components.layout.update(r,i),(0,a.promiseApplied)(e)}},style:{get:function(e,t,n,o){var r=o.componentRef;return e.components.style.get(r)},update:function(e,t,n,o){var r=o.componentRef,i=o.style;return e.components.style.setCustom(r,null,i),(0,a.promiseApplied)(e)}},modes:{showComponentOnlyOnPagesGroup:function(e,t,n,o){var r=o.componentPointer,i=o.componentRef,p=void 0===i?r:i,u=o.pagesGroupPointer;return e.components.modes.showComponentOnlyOnPagesGroup(p,u),(0,a.promiseApplied)(e)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o};t.default={install:function(e,t,n,o){return new Promise(function(n,r){i.default.get(o,"appDefinitionId")?e.platform.provision(o.appDefinitionId,{origin:{type:"APP",info:{appDefinitionId:i.default.get(t,"appDefinitionId")}}}).then(n,r):r(new Error("options must contain appDefinitionId"))})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mobile=t.vfs=t.tpa=t.theme=t.fonts=t.siteSegments=t.routers=t.pagesGroup=t.pages=t.menu=t.language=t.info=t.history=t.controllers=t.components=t.application=void 0;var o=A(n(19)),r=A(n(18)),i=A(n(17)),a=A(n(16)),p=A(n(15)),u=A(n(14)),f=A(n(13)),d=A(n(12)),l=A(n(11)),s=A(n(10)),c=A(n(9)),g=A(n(8)),m=A(n(7)),v=A(n(6)),I=A(n(5)),y=A(n(4));function A(e){return e&&e.__esModule?e:{default:e}}t.application=o.default,t.components=r.default,t.controllers=i.default,t.history=p.default,t.info=u.default,t.language=f.default,t.menu=d.default,t.pages=l.default,t.pagesGroup=s.default,t.routers=c.default,t.siteSegments=g.default,t.fonts=a.default,t.theme=m.default,t.tpa=v.default,t.vfs=I.default,t.mobile=y.default}])});
//# sourceMappingURL=platform-api.min.js.map